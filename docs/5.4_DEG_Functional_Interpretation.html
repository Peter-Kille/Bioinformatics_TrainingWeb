<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Prof Peter Kille">
<meta name="dcterms.date" content="2025-01-06">

<title>Functional Interpretation of DEG Lists</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b512256bc363577b27543e003c495f0c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: white;
      }

      .quarto-title-block .quarto-title-banner {
        color: white;
background: darkred;
      }
</style>
<link href="site_libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet">



<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./5.0_Transcriptomics_Introduction.html">Session 5. Transcriptomics</a></li><li class="breadcrumb-item"><a href="./5.4_DEG_Functional_Interpretation.html">Functional Interpretation of DEG Lists</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./5.0_Transcriptomics_Introduction.html">Session 5. Transcriptomics</a></li><li class="breadcrumb-item"><a href="./5.4_DEG_Functional_Interpretation.html">Functional Interpretation of DEG Lists</a></li></ol></nav>
      <h1 class="title">Functional Interpretation of DEG Lists</h1>
            <p class="subtitle lead">Genes to Biology</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Prof Peter Kille </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 6, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Welcome to Bioinformatics!</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Big Data Biology and Bioinformatics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Session 0. HPC and Personal Cloud</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0.1_Personal_Cloud.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Personal Cloud</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Session 1. Linux: The basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.1_Introduction_to_Linux.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Linux</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.2_Loading_Software_Accessing_Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loading Software and Accessing Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.3_Commandline_Tools_and_Scripting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extension: Commandline Tools and Scripting</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Session 2. NGS data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.1_NGS_Quality_Control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NGS Quality Control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.2_genome_assembly.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Genome Assembly</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.3_hybrid_assemblies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extension: Hybrid Assemblies</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Session 3. Genomics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3.1_Genome_visualisation_and_annotation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Genome Visualisation and Annotation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3.2_Annotating_mitochondria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extension: Annotating Mitochondrial Genomes</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Session 4. Building phylogenies</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4.1_phylogentics_phylogenomics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Phylogenetics and Phylogeneomics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4.2_phylogentics_phylogenomics_extension.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extension: Phylogenetics and Phylogeneomics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Session 5. Transcriptomics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5.0_Transcriptomics_Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transcriptomics: An Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5.1_RNAseq_processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RNAseq Processing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5.2_GEO_Open_Data_Archive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gene Expression Omnibus (GEO)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5.3_DEG_Generation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Processing : Generation of DEG Lists</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5.4_DEG_Functional_Interpretation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Functional Interpretation of DEG Lists</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5.5_Refined_Data_Representations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Refined Data Representation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Session 6. Microbial community analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6.1_metabarcoding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metagenomics</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#workshop-overview" id="toc-workshop-overview" class="nav-link active" data-scroll-target="#workshop-overview">Workshop Overview</a>
  <ul class="collapse">
  <li><a href="#gene-ids-gene-symbols-or-probe-ids" id="toc-gene-ids-gene-symbols-or-probe-ids" class="nav-link" data-scroll-target="#gene-ids-gene-symbols-or-probe-ids">Gene IDs, Gene Symbols or Probe IDs</a></li>
  </ul></li>
  <li><a href="#key-statistical-concept---fishers-exact-test-and-enrichment-analysis" id="toc-key-statistical-concept---fishers-exact-test-and-enrichment-analysis" class="nav-link" data-scroll-target="#key-statistical-concept---fishers-exact-test-and-enrichment-analysis">Key Statistical Concept - Fisher’s Exact Test and Enrichment Analysis</a></li>
  <li><a href="#filtering-gene-lists" id="toc-filtering-gene-lists" class="nav-link" data-scroll-target="#filtering-gene-lists">4.1 Filtering Gene Lists</a>
  <ul class="collapse">
  <li><a href="#excel" id="toc-excel" class="nav-link" data-scroll-target="#excel">Excel</a></li>
  <li><a href="#excel-data-convert-menu" id="toc-excel-data-convert-menu" class="nav-link" data-scroll-target="#excel-data-convert-menu"><img src="images/Excel_convert_menu.png" class="img-fluid" width="150" alt="Excel Data Convert Menu"></a></li>
  <li><a href="#r" id="toc-r" class="nav-link" data-scroll-target="#r">R</a></li>
  </ul></li>
  <li><a href="#a-clusterprofiler" id="toc-a-clusterprofiler" class="nav-link" data-scroll-target="#a-clusterprofiler">4.2A ClusterProfiler</a></li>
  <li><a href="#b-david" id="toc-b-david" class="nav-link" data-scroll-target="#b-david">4.2B DAVID</a>
  <ul class="collapse">
  <li><a href="#gene-enrichment-analysis-with-david" id="toc-gene-enrichment-analysis-with-david" class="nav-link" data-scroll-target="#gene-enrichment-analysis-with-david">Gene Enrichment Analysis with David</a></li>
  <li><a href="#start-analysis-and-upload-you-data" id="toc-start-analysis-and-upload-you-data" class="nav-link" data-scroll-target="#start-analysis-and-upload-you-data">1. Start analysis and upload you data</a></li>
  <li><a href="#generate-functional-analysis-of-gene-list" id="toc-generate-functional-analysis-of-gene-list" class="nav-link" data-scroll-target="#generate-functional-analysis-of-gene-list">2. Generate Functional Analysis of gene list</a></li>
  <li><a href="#review-gene-ontology-enrichment" id="toc-review-gene-ontology-enrichment" class="nav-link" data-scroll-target="#review-gene-ontology-enrichment">3. Review Gene Ontology Enrichment</a></li>
  <li><a href="#pathway-analysis" id="toc-pathway-analysis" class="nav-link" data-scroll-target="#pathway-analysis">4. Pathway analysis</a></li>
  <li><a href="#functional-annotation-clustering" id="toc-functional-annotation-clustering" class="nav-link" data-scroll-target="#functional-annotation-clustering">5. Functional Annotation Clustering</a></li>
  </ul></li>
  <li><a href="#c-gpofiler" id="toc-c-gpofiler" class="nav-link" data-scroll-target="#c-gpofiler">4.2C gPofiler</a></li>
  <li><a href="#d-string-db" id="toc-d-string-db" class="nav-link" data-scroll-target="#d-string-db">4.2D String-db</a></li>
  <li><a href="#semantic-similarity-with-revigo" id="toc-semantic-similarity-with-revigo" class="nav-link" data-scroll-target="#semantic-similarity-with-revigo">4.3 Semantic similarity with Revigo</a>
  <ul class="collapse">
  <li><a href="#export-go-terms-and-p-values" id="toc-export-go-terms-and-p-values" class="nav-link" data-scroll-target="#export-go-terms-and-p-values">1. Export GO terms and P-values</a>
  <ul class="collapse">
  <li><a href="#a.-gprofiler" id="toc-a.-gprofiler" class="nav-link" data-scroll-target="#a.-gprofiler">1A. gprofiler</a></li>
  <li><a href="#b.-david" id="toc-b.-david" class="nav-link" data-scroll-target="#b.-david">1B. DAVID</a></li>
  </ul></li>
  <li><a href="#revigo-data-entry" id="toc-revigo-data-entry" class="nav-link" data-scroll-target="#revigo-data-entry">2. Revigo data entry</a></li>
  <li><a href="#review-revigo-results" id="toc-review-revigo-results" class="nav-link" data-scroll-target="#review-revigo-results">3. Review Revigo Results</a></li>
  </ul></li>
  <li><a href="#gene-networks-in-stringdb" id="toc-gene-networks-in-stringdb" class="nav-link" data-scroll-target="#gene-networks-in-stringdb">4.4 Gene Networks in Stringdb</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="workshop-overview" class="level1">
<h1>Workshop Overview</h1>
<p>You have generated a list of Differentially Expressed Genes (DEGs) passing a inital set of criteria you have defined. There are 2 criteria that are commonly used; 1) Statistical = filtered on PAdj (FDR adjusted p-value); and, 2) Level of response, fold change (FC) - filtered on log2FC (log 2 Fold Change).</p>
<p>For SARTools &amp; Geo2R data both of these parameters are in you output file but GEO Dataset ‘analsyis ’profile_data.txt’ output only provides normalised counts with full metadata provided in dedicated row along the top. You can manually reformat this data to generate Log2FC but without access to the original raw data PAdj cannot be calculated. You can <a href="#%204.1%20Filtering%20Gene%20Lists">refilter your list</a> to increase or decrease you stringency. Also you may want to expoloit <a href="https://peter-kille.github.io/Bioinformatics_TrainingWeb/5.5_Refined_Data_Representations.html#venn-diagrams">venn diagram</a> approaches to generate a DEG list that are common to specific treatments or timepoints. These refined gene lists may provide increased insight to the biology than just a binary comparison.</p>
<section id="gene-ids-gene-symbols-or-probe-ids" class="level2">
<h2 class="anchored" data-anchor-id="gene-ids-gene-symbols-or-probe-ids">Gene IDs, Gene Symbols or Probe IDs</h2>
<p>One of the most sigificant challenges for functional interpretation is navigating from what seems to be uninteligable codes associated with your DEGs to informative biological functions. The tools achive this by linking the Gene ID, Gene Symbol or Probe ID you provide with know functional descriptions. Some IDs are easier to link than others, for instance <a href="#%204.2D%20String-db">StringDB</a> and <a href="#%204.2C%20gPofiler">gProfiler</a> Ensembl Gene ID and Uniprot IDs link to the Uniprot ‘data warehouse’ that integrates lots of data sources to provide rich functional information. In contrast <a href="#%204.2B%20DAVID">DAVID</a> also uses Entrez gene IDs as well and specific species ID - flybase ect as well as links to many array IDs (Affymetric and Agilent). There are ID converts - <a href="https://www.uniprot.org/id-mapping">Uniprot Retrieve/IDs</a> requires you to know the ID you are mapping whilst <a href="https://davidbioinformatics.nih.gov/conversion.jsp">DAVID’s converter tool</a> will try and identify the best match from the IDs you provide - this can be very useful if you dont know where the IDs are you are using. The most robust but hardest to configure is <a href="#%204.2A%20ClusterProfiler">ClusterProfiler</a> because you provide the mapping file - this can very chanllenging to crfeate but once done you are in control and know specifically how the mapping is happening.</p>
</section>
</section>
<section id="key-statistical-concept---fishers-exact-test-and-enrichment-analysis" class="level1">
<h1>Key Statistical Concept - Fisher’s Exact Test and Enrichment Analysis</h1>
<p>The workshop will use tools that exploit statistical approaches to identify the biological pathways or processes that are over represented (some time refereed to as enriched) within the DEGs. You will not need to derive the mathematical formula underpinning these concepts or deploy the algorithums from first principles since the software you will use does this for you but it is worth knowing the background. There is an excellent academic from UNC-Chapel Hill, Prof Josh Starmer, who runs a youtube channel called <a href="https://www.youtube.com/channel/UCtYLUTtgS3k1Fg4y5tAhLbw">StatQuest</a> this deal with a large range of biological stats and has some great annotations to explain them, I am going to suggest you watch two of his videos to orientate you about the key statistical concepts for this session:</p>
<div class="cell">
<div class="cell-output-display">
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/udyAvvaMjfM" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
</div>
</section>
<section id="filtering-gene-lists" class="level1">
<h1>4.1 Filtering Gene Lists</h1>
<section id="excel" class="level2">
<h2 class="anchored" data-anchor-id="excel">Excel</h2>
<p>All of the DEG outputs we have discussed can be imported into Excel and filtered and maniputated. However, there are a couple of potential pits falls you want to avoid especially linked to data import; 1) Scientific Numbers, and; 2) NA or empty cells. The first is relative straightforward - the DEG lists you have generated will have Padj expressed as an scientific number <code>2.7445146621638e-07</code> if you drag-and-drop the DEG list into excel or just try to open the file you will be asked the question <strong>Convert Digits surrounding the letter “E” into scientific notation</strong> - you much agree to convert these so they will be recognised as true numbers. R also may generate spreadsheets which contain <strong>NA</strong> entries, usually indicating an error in calculation for instance a number result from dividing by zero or log(0). On import the columns that contain NAs will not be treated as numbers therefore preventing you filtering - this means when you import these columns you should replace the NA with an number that removes them from analysis (ie pAdj=1 or Log2FC=0) or remove the entire row.</p>
<p>To import into excel, Open Blank Workbook in Excel <code>Data &gt; Get Data &gt; From File &gt; Text/CSV</code>. Now Navigate and select file to open. At the bottom right of window look for icons ‘load’, Transform Data’ and ‘Cancel’, select <strong>Tranform Data</strong>. This menu allows you to configure your spreadsheet - you can remove unwanted columns ect at this point. However, the main issue is to check that Excel us importing the numbers correctly. If you navigate to the top of the Log2FC column you may see a icon ABC icon as seen in the following.</p>
</section>
<section id="excel-data-convert-menu" class="level2">
<h2 class="anchored" data-anchor-id="excel-data-convert-menu"><img src="images/Excel_convert_menu.png" class="img-fluid" width="150" alt="Excel Data Convert Menu"></h2>
<p>This indicates that excel has not correctly identified the column as a <strong>Decimal Number</strong> - click on teh icon and correct it to a <strong>Decimal Number</strong>. You will be presented wiyth an option asking you to confirm the ‘type conversion’ - select <code>replace current</code>. Now repreat the processes for the other columns that you will be filtering on. When you are finish select <code>Close and Load Data</code> - it is the Icon at the top left of the window. The speadsheet will now open - not that the <strong>NA</strong> has been replaced by a blank. Finally to ensure correct filtering - navigate to the columns reprresenting Log2FC and search and replace all <strong>blanks</strong> with <strong>0</strong> and for pAdj search and replace all <strong>blanks</strong> with <strong>1</strong>. Now if you select the down arrows that have appear in the column heads you can select numeric filetring and apply your filtering criteria. When I have filtered I will copy the filtered gene list into a new worksheet labeled with the criterion I have used - this allows me to keep track of things.</p>
<p>** As you can see Excel is not the easy choice**</p>
</section>
<section id="r" class="level2">
<h2 class="anchored" data-anchor-id="r">R</h2>
<p>For <strong>SARTools</strong> outputs we have configured a <code>Filtering.r</code> script - copy this into work workdir and open it through your POSIT R studio (or loacl Rstudio interface).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> ~/classdata/Session5/RNAseq-Analysis/Filtering.r ~/mydata/<span class="pp">[</span><span class="ss">workdir</span><span class="pp">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Filtering Script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Mark genes that are differentially expressed and filter to just look at those</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Read in your Rdata that you saved previously</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"projectName.RData"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Put the DESeq2 results objects into a list called deData</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>deData<span class="ot">&lt;-</span>out.DESeq2<span class="sc">$</span>results</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a factor indicating which genes are DE</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#For a gene to be DE in a pairwise comparison it needs to be a) significant overall and b) have a log2FC &gt;1</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>indicateDEGS<span class="ot">&lt;-</span><span class="cf">function</span>(deData){</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  DE<span class="ot">&lt;-</span>deData<span class="sc">$</span>padj <span class="sc">&lt;=</span> <span class="fl">0.05</span> <span class="co">#Set P (adjusted) cut off</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  DE[<span class="fu">is.na</span>(DE)]<span class="ot">&lt;-</span><span class="cn">FALSE</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  DE[deData<span class="sc">$</span>log2FoldChange <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> deData<span class="sc">$</span>log2FoldChange <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="cn">FALSE</span> <span class="co">#Set fold change cut off</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(DE)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">names</span>(deData)){</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  deData[[i]]<span class="sc">$</span>DE<span class="ot">&lt;-</span><span class="fu">indicateDEGS</span>(deData[[i]])</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Filter the Deletion_vs_Control to just see DE genes </span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(<span class="fu">as.data.frame</span>(deData<span class="sc">$</span>Deletion_vs_Control[deData<span class="sc">$</span>Deletion_vs_Control<span class="sc">$</span>DE<span class="sc">==</span>T,]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Adpation of filtering for Geo2R
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If you have generated output from <strong>Geo2R</strong> you will need to input this into R by adding the following code at the beinign of the script:</p>
<pre><code>deData &lt;- read.table(file = '[Geo2R_output.tsv]', sep = '\t', header = TRUE)</code></pre>
<p>Also on line 12 and 14 make the following changes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># line 14</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">DE</span><span class="op">&lt;</span>-deData<span class="va">$padj</span> <span class="op">&lt;</span>= 0.05 <span class="co">#replace with</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="ex">DE</span><span class="op">&lt;</span>-deData<span class="va">$adj</span>.P.Val</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># line 16</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="va">DE</span><span class="op">[</span>deData<span class="va">$log2FoldChange</span> &lt; 1 &amp; deData<span class="va">$log2FoldChange</span> &gt; -1<span class="op">]</span> <span class="co"># replace with DE[deData$logFC &lt; 1 &amp; deData@logFC &gt; -1]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="a-clusterprofiler" class="level1">
<h1>4.2A ClusterProfiler</h1>
<p>We have configured a <code>GOenrichment.r</code> script - copy this into work workdir and open it through your POSIT R studio (or loacl Rstudio interface).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> ~/classdata/Session5/RNAseq-Analysis/GOenrichment.r ~/mydata/<span class="pp">[</span><span class="ss">workdir</span><span class="pp">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Follow the instructions in the script.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
GOenrichment
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">###Over-representation analysis</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="do">## You will need to have already fun the filtering script to mark which genes in the DESeq results are differentially expressed</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Install packages</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#BiocManager::install("GO.db", lib.loc="/home/sbi9srj/mydata/Rpackages")</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#BiocManager::install("clusterProfiler", lib.loc="/home/sbi9srj/mydata/Rpackages")</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#BiocManager::install("AnnotationDbi", lib.loc="/home/sbi9srj/mydata/Rpackages")</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GO.db)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(clusterProfiler)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Get GO terms for each gene from ensembl</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Select your genome and download the fields Gene.stable.ID, Transcript.stable.ID, GO.term.accession, GO.term.name and Gene.name </span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Downloaded from http://www.ensembl.org/biomart/martview/6207f5f59f2bbb4ec6a6fdc752f28c1e</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>go<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"~/classdata/go_map.csv"</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>fullgo<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">as.list</span>(GOTERM),<span class="fu">as.list</span>(GOOBSOLETE))</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Add in the gene IDs to the DESeq results</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">names</span>(deData)){</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  deData[[i]]<span class="sc">$</span>ID<span class="ot">&lt;-</span>go<span class="sc">$</span>Transcript.stable.ID[<span class="fu">match</span>(<span class="fu">rownames</span>(deData[[i]]), go<span class="sc">$</span>Gene.stable.ID)]</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Create some plotting functions</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>mod.barplot<span class="ot">&lt;-</span><span class="cf">function</span>(obj, ont, ...){</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  obj<span class="sc">@</span>result<span class="ot">&lt;-</span>obj<span class="sc">@</span>result[obj<span class="sc">@</span>result<span class="sc">$</span>Ontology<span class="sc">==</span>ont,]</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">barplot</span>(obj, ...)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Only DEGs in each comparison at P &lt;= 0.05</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Enrichment relative to annotated genes present in transcriptome</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="co">#Make a list for outputs</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>GO.out<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">names</span>(deData)){</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  GO.out[[i]]<span class="ot">&lt;-</span><span class="fu">enricher</span>(deData[[i]][,<span class="st">"ID"</span>][deData[[i]][,<span class="st">"DE"</span>]<span class="sc">==</span><span class="st">"TRUE"</span>], </span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>                              <span class="at">universe =</span> deData[[i]][,<span class="st">"ID"</span>], </span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>                              <span class="at">TERM2GENE=</span>go[,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>)], <span class="at">TERM2NAME=</span>go[,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)],</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>                              <span class="at">pvalueCutoff =</span> <span class="dv">1</span>, <span class="at">qvalueCutoff    =</span> <span class="dv">1</span>)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  GO.out[[i]]<span class="sc">@</span>result[GO.out[[i]]<span class="sc">@</span>result<span class="sc">$</span>p.adjust <span class="sc">&lt;=</span> <span class="fl">0.05</span>,]</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualise one of them</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(GO.out<span class="sc">$</span>Deletion_vs_Control)</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a><span class="co">#Add in ontology info (BP, CC or MF)</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">names</span>(GO.out)){</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>  GO.out[[i]]<span class="sc">@</span>result<span class="sc">$</span>Ontology<span class="ot">&lt;-</span><span class="fu">as.factor</span>(<span class="fu">sapply</span>(<span class="fu">match</span>(GO.out[[i]]<span class="sc">@</span>result<span class="sc">$</span>ID,<span class="fu">names</span>(fullgo)), <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(x)) {<span class="fu">Ontology</span>(fullgo[[x]])} <span class="cf">else</span> {<span class="cn">NA</span>}))</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot barplots for each separately</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a><span class="fu">mod.barplot</span>(GO.out<span class="sc">$</span>Deletion_vs_Control, <span class="at">ont =</span> <span class="st">"BP"</span>, <span class="at">title =</span> <span class="st">"BP Enrichment"</span>, <span class="at">showCategory =</span> <span class="dv">15</span>, <span class="at">font.size =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="b-david" class="level1">
<h1>4.2B DAVID</h1>
<p>Database for Annotation, Visualization and Integrated Discovery - DAVID</p>
<p>David Web site - https://david.ncifcrf.gov/</p>
<section id="gene-enrichment-analysis-with-david" class="level2">
<h2 class="anchored" data-anchor-id="gene-enrichment-analysis-with-david">Gene Enrichment Analysis with David</h2>
<p>[David - Database for Annotation, Visualization and Integrated Discovery] (https://david.ncifcrf.gov/) was the tool to use for gene enrichment from 2005 - 2016 but the database it hosted became out of date due to a break in the research groups funding. From 2016 (gprofiler)[https://biit.cs.ut.ee/gprofiler/gost] and (stringdb)[https://string-db.org/] have been prefered because they have been kept upto date. However, DAVID was refunded and a 2021 update means it is back to being maintained. Although there will not be time to explore it in our workshop the following workshop and video is there to support anyone wanting to explore its functionality.</p>
</section>
<section id="start-analysis-and-upload-you-data" class="level2">
<h2 class="anchored" data-anchor-id="start-analysis-and-upload-you-data">1. Start analysis and upload you data</h2>
<p>Select <strong><em>&lt; start analysis &gt;</em></strong></p>
<p>Paste in you gene list (1) in box (A) and, select identifier (2), and identify as a Gene List (3). Select your species (2a) . In more nuanced analysis you may wish to define your own background - this is useful when working with non-model organisms or if your starting population does not represent the entire genome.</p>
<p><img src="images/david_upload.png" class="img-fluid" alt="DAVID Upload"> <strong><em>DAVID Upload</em></strong></p>
<p>now select <strong><em>&lt; Submit List &gt;</em></strong></p>
</section>
<section id="generate-functional-analysis-of-gene-list" class="level2">
<h2 class="anchored" data-anchor-id="generate-functional-analysis-of-gene-list">2. Generate Functional Analysis of gene list</h2>
<p>If you have used a non-regulate gene identifier or it does not recognize the identifier type you have used it may ask you to convert the identifiers - check the programs suggestion - it is usually good but you should check.</p>
<p>Select <strong><em>&lt; Functional Annotation Tool &gt;</em></strong></p>
<p>You will now be give a annotation summary as shown below:</p>
<p><img src="images/david_annotation_summary.png" class="img-fluid" alt="Annotation Summary"> <strong><em>Annotation Summary</em></strong></p>
<p>You will see a range of categories for which the functional annotation has been performed. The analysis told has not only cross referenced the gene list against a range of functional databases it has also analysed the gene co-appearance in citations (Literature), links to disease (Disease) and Interactions agonist other linkages.</p>
</section>
<section id="review-gene-ontology-enrichment" class="level2">
<h2 class="anchored" data-anchor-id="review-gene-ontology-enrichment">3. Review Gene Ontology Enrichment</h2>
<p>Let us consider the functional enrichment using (Gene Ontology)[http://geneontology.org/]. Gene Ontology categorizes gene products using three distinct characteristics - Molecular Function (biochemistry of the product), Cellular Component (where it appears in the cell), and the Biological Processes - see more about these classification by reviewing the (Gene Ontology Overview documentation)[http://geneontology.org/docs/ontology-documentation/]. Although ontologies are hierarchical, they are not a simple classification system, they not only allow for gene products to be involved with multiple processes the relationship between elements in the hierarchy are closely defined. The ontology also allows for classification to be as specific or detailed as knowledge allows ie if a protein is a transporter but what it transports is not known it will be defined by a mid-level term ‘transporter’ but if it is known to transport Zn it will be classified at a ‘Zinc transport’ as well as a ‘transporter’. Enrichment analysis uses fisher exact test (see about) to calculate the enrichment at each of these ‘levels’ - although I usually choose to look at the integrated data summarized under the ‘GOTERM_[BP/CC/MF]_DIRECT’.</p>
<p>click on the + next too the <strong><em>&lt; Gene_Ontology &gt;</em></strong> category</p>
<p>Select <strong><em>&lt; Chart &gt;</em></strong> right of the GOTERM_BP_DIRECT</p>
<p><img src="images/David_BP_enrichment.png" class="img-fluid" alt="BP Enrichment"> <strong><em>BP Enrichment</em></strong></p>
<p>Note the P-value and benjamini correct p-value displaying the like hood that those specific Go terms are represented by random - i.e.&nbsp;lost the P-value the less likely the representation of the term is a random select , therefore the more likely the term is enriched.</p>
<p>To see the list of gene involved in for instance ‘positive regulation of osteoblast differentiation’ click on the blue bar under the ‘Genes’ column.</p>
<p>This is the list you will see:</p>
<p><img src="images/osteoblast_differentiation.png" class="img-fluid" alt="positive regulation of osteoblast differentiation"> <strong><em>positive regulation of osteoblast differentiation</em></strong></p>
<p>Now review enrichment for Cell Component and Molecular Function.</p>
</section>
<section id="pathway-analysis" class="level2">
<h2 class="anchored" data-anchor-id="pathway-analysis">4. Pathway analysis</h2>
<p>click on the + next too the <strong><em>&lt; Pathways &gt;</em></strong> category</p>
<p><img src="images/David_pathways.png" class="img-fluid" alt="Pathway Options"> <strong><em>Pathway Options</em></strong></p>
<p>Select <strong><em>&lt; Chart &gt;</em></strong> right of the KEGG</p>
<p><img src="images/Kegg_enrichment.png" class="img-fluid" alt="KEGG Enrichment"> <strong><em>KEGG Enrichment</em></strong></p>
<p>You will see a list of enriched pathways - Note the P-value and benjamini correct p-value displaying the like hood that those specific pathways are represented by random - i.e.&nbsp;lost the P-value the less likely the representation of the pathway is a random select, therefore the more likely the pathways is enriched.</p>
<p>click on the <strong><em>&lt; TNF Signalling Pathway &gt;</em></strong>_ in the term column</p>
<p>This will display the pathway with the terms that are present in the list shown with red stars or highlight by redtext below the figure.</p>
<p><img src="images/TNF.png" class="img-fluid" alt="TNF Signalling Pathway"> <strong><em>TNF Signalling Pathway</em></strong></p>
<p>Explore some more pathways</p>
</section>
<section id="functional-annotation-clustering" class="level2">
<h2 class="anchored" data-anchor-id="functional-annotation-clustering">5. Functional Annotation Clustering</h2>
<p>DAVID attempts to summarise enrichment between categorization systems using a tool it terms - Functional annotation clustering. If you select this for you current data set. you will be provided with the following clusters:</p>
<p><img src="images/Functional_Annotation_Clustering.png" class="img-fluid" alt="Functional Annotation Clustering"> <strong><em>Functional Annotation Clustering</em></strong></p>
<p>Each cluster is assigned an enrichment score under which ‘terms’ that are enriched under different classification systems are displayed grouped together. Each ‘grouping’ is given a ‘Enrichment Score’ the larger the enrichment score the higher the score the more likely that cluster is being enriched. Note that the is a ‘Classification Stringency’ pull down menu that allows you to define the strength of associated of the term being grouped together.</p>
<p>For annotation Cluster 6 (which contains lots of Metallothionein/cadimum associated terms) there is a small green and black box - after the Enrichment Score and the ‘G’ - click on this box. This brings up a cluster matrix showing the gene gene products on the Y-axis and the classification ‘vlasses’ on the X-axis.</p>
<p><img src="images/cluster_matrix.png" class="img-fluid" alt="cluster matrix"> <strong><em>Cluster Matrix</em></strong></p>
<p><a href="https://cf.sharepoint.com/:b:/t/SystemsBiology/EREU-YiocCJGum6A7Nn6AJIBU0G6bvJtdrUy5m6Ba5yspg?e=M9l56F">David Workshop</a></p>
<section id="enrichment-with-david-panopto" class="level4">
<h4 class="anchored" data-anchor-id="enrichment-with-david-panopto"><a href="https://cardiff.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=e714981c-6144-49f5-9d24-ab6b00d22977">Enrichment with David Panopto</a></h4>
</section>
</section>
</section>
<section id="c-gpofiler" class="level1">
<h1>4.2C gPofiler</h1>
<ol type="1">
<li>Load you DEG list</li>
</ol>
<p>Paste you DEG list into the box and click on <strong><em>&lt; Run query &gt;</em></strong> (I suggest you select Benjamin-Hochberg FDR under Advanced options)</p>
<p><img src="images/gprofiler_upload.png" class="img-fluid" alt="gprofiler upload data"> <strong><em>gprofiler upload data</em></strong></p>
<p>You may be asked if you wish to confirm gene identified - if you are accept the selected options.</p>
<ol start="2" type="1">
<li>Review Enrichment</li>
</ol>
<p>You will be presented with and enrichment summary.</p>
<p><img src="images/Enrichment_summary.png" class="img-fluid" alt="Enrichment Summary"> <strong><em>Enrichment Summary</em></strong></p>
<p>Here the y-axis is -log10(adjPValue) - so the larger the number the more improbably the functional representation is there by random. The size of the symbols represent the number of genes in each category.</p>
<p>Now select <strong><em>&lt; Detailed Results &gt;</em></strong> this is a tab that is displayed about halfway down the page</p>
<p><img src="images/gprofiler_detailed_results.png" class="img-fluid" alt="gprofiler detailed results"> <strong><em>gprofiler detailed results</em></strong></p>
<p>Note:</p>
<p>Adjusted p-value if give next to each term</p>
<p>Top of the detailed results page there is ‘CSV’ option to download the data into a spreadsheet format.</p>
<ol start="3" type="1">
<li>Consider the Transcription Factor enrichment.</li>
</ol>
<p>Gene regulation is at the heart of DEGs - co-regulated gene should should have direct or indirect regulatory network moderated through conserved transcription factor binding sites.</p>
<p><img src="images/TF_enrichment.png" class="img-fluid" alt="Transcription Factor enrichment"> <strong><em>Transcription Factor enrichment</em></strong></p>
<p><a href="https://cardiff.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=5cebe4ce-805f-4d72-bf17-ab6b01103ae5">gprofiler panopto</a></p>
</section>
<section id="d-string-db" class="level1">
<h1>4.2D String-db</h1>
<p><a href="https://string-db.org/">STRING</a></p>
<ol type="1">
<li>Login to String-db</li>
</ol>
<p>Open String-db and login using an appropriate account</p>
<ol start="2" type="1">
<li>Upload your data</li>
</ol>
<p>Select <strong><em>&lt; My data &gt;</em></strong> from top menu</p>
<p>Select <strong><em>&lt; create new gene set &gt;</em></strong> under <strong><em>&lt; Your stored gene sets &gt;</em></strong></p>
<p>Give you Gene List a Name, select Homo sapiens as species and past in your gene symbols</p>
<p><img src="images/String_new_gene_set.png" class="img-fluid" alt="New Gene Set in STRING-db"> <strong><em>New Gene Set in STRING-db</em></strong></p>
<p>Select <strong><em>&lt; continue &gt;</em></strong></p>
<p>if asked to review mappings <strong><em>&lt; please review the mappings … &gt;</em></strong> select continue</p>
<ol start="3" type="1">
<li>Explore Gene Enrichment</li>
</ol>
<p>Review stored Gene set and select <strong><em>&lt; analyse &gt;</em></strong></p>
<p><img src="images/Stored_gene_set.png" class="img-fluid" alt="Stored Gene Set in STRING-db"> <strong><em>Stored Gene Set in STRING-db</em></strong></p>
<p>Review Enrichment analysis</p>
<p><img src="images/String-db_enrichment.png" class="img-fluid" alt="Enrichment analysis in STRING-db"> <strong><em>Enrichment analysis in STRING-db</em></strong></p>
</section>
<section id="semantic-similarity-with-revigo" class="level1">
<h1>4.3 Semantic similarity with Revigo</h1>
<p>Revigo can take long lists of Gene Ontology terms and summarize them by removing redundant GO terms using semantic similarity. The input you need is a list of GO terms in the format <code>GO:[NUMBER]</code> a tab and the associated p-value.</p>
<section id="export-go-terms-and-p-values" class="level2">
<h2 class="anchored" data-anchor-id="export-go-terms-and-p-values">1. Export GO terms and P-values</h2>
<section id="a.-gprofiler" class="level3">
<h3 class="anchored" data-anchor-id="a.-gprofiler">1A. gprofiler</h3>
<p>Under the detailed results menu there is a <code>CSV</code> icon which when clicked can be used to export your enriched terms as a CSV which can then be imported into excel. You can use the associated setting button (the cog symbol next toi the CSV) to select only GO terms to export for this exercise.</p>
<p><img src="images/gprofiler_export.png" class="img-fluid" alt="gprofiler export"> <strong><em>gprofiler export</em></strong></p>
<p>You will then need to copy column C and D into Revigo</p>
</section>
<section id="b.-david" class="level3">
<h3 class="anchored" data-anchor-id="b.-david">1B. DAVID</h3>
<p>After you have completed the functional analysis select <strong><em>&lt; Gene_ontology &gt; GOTERM_BP_DIRECT &gt; Chart &gt;</em></strong></p>
<p>now Select <strong><em>&lt; Download File &gt;</em></strong></p>
<p><img src="images/david_go_download.png" class="img-fluid" alt="DAVID Go Dowbload"> <strong><em>DAVID Go Download</em></strong></p>
<p>This will either display the enrichment table into the browser window or ask for a save location depending on your browser settings. If you are not asked for a save location right hand click the displayed table and select <code>Save as</code> and save to a appropriate location as a text file. This text file can be opened/imported into excel. You will file the GO term is concatenated with the GO description in Column B. To split this insert a blank column after column B, then select column B and select menu option <strong><em>&lt; Data &gt; Test to columns &gt;</em></strong>. Select <strong><em>&lt; Delimited &gt; Next &gt;</em></strong>_ and use the radio button to select <strong><em>other</em></strong> and add a <strong><em>~</em></strong>_ to the box directly to the right of this option. Now click <strong><em>&lt; Next and Finish &gt;</em></strong>. You will see the GO term in now in Column B and the P-value in column F. Select these columns and paste them into Revigo.</p>
<p>You should now repeat this process for Molecular Function and Cell Component Terms.When all the data is merged you can paste the GO term and P value into Revigo.</p>
</section>
</section>
<section id="revigo-data-entry" class="level2">
<h2 class="anchored" data-anchor-id="revigo-data-entry">2. Revigo data entry</h2>
<p>Enter GO terms and P-values into Revigo - they should be in format</p>
<pre><code>Term    PValue
GO:0045892  7.75E-06
GO:0006694  3.29E-04</code></pre>
<p>Leave the default settings and select <strong><em>&lt; Start Revigo &gt;</em></strong></p>
</section>
<section id="review-revigo-results" class="level2">
<h2 class="anchored" data-anchor-id="review-revigo-results">3. Review Revigo Results</h2>
<p>For each GO term category Revigo will generate a Scatterplot, Table, 3D scatter plot, interactive Graph and Tree Map. <strong><em>Note: at the bottom of each plot there are export options for R and other formats</em></strong> _.</p>
<p>The most intuitive format is are the Tree Maps (see below) whilst the Scatterplot output table, which include terms like ‘Frequency and Uniqueness’ can be used to create networks in Cytoscape.</p>
<p><img src="images/Revigo_BP_TreeMap.png" class="img-fluid" alt="Revigo BP TreeMap"> <strong><em>Revigo BP TreeMap</em></strong></p>
<p><a href="https://cf.sharepoint.com/:b:/t/SystemsBiology/EX0QBkPbAUpGoWALa5uyXFQBmvxV5yTI5aYOq3f5pI1W2w?e=cBpqbh">Revigo Workshop</a></p>
<p><a href="https://cardiff.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=f3a44879-12cc-406d-bb95-ab6b00e23416">Revigo Panopto</a></p>
</section>
</section>
<section id="gene-networks-in-stringdb" class="level1">
<h1>4.4 Gene Networks in Stringdb</h1>
<p><a href="https://string-db.org/">STRING</a></p>
<ol type="1">
<li>Login to String-db</li>
</ol>
<p>Open String-db and login using an appropriate account</p>
<ol start="2" type="1">
<li>Review your datauploads</li>
</ol>
<p>select one of your dataset and now select <strong><em>&lt; show &gt;</em></strong></p>
<p>Select <strong><em>&lt; view as a interactive network &gt;</em></strong></p>
<p>You will now see a very large and detailed network - go to bottom on page and select settings and change to match the following settings. The select <strong><em>&lt; update &gt;</em></strong></p>
<p><img src="images/String_db_settings.png" class="img-fluid" alt="STRING-db Settings"> <strong><em>STRING-db Settings</em></strong></p>
<p>First_network</p>
<p><img src="images/First_network.png" class="img-fluid" alt="STRING-db Network"> <strong><em>STRING-db Network</em></strong></p>
<p>Now play and refine your network - try clusting using 3 clusters</p>
<p>[STRING Panopto](https://cardiff.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=edfe7653-7e16-45b0-8e1e-ac7401079592</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>