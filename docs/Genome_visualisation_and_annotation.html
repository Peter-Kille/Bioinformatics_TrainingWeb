<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Prof Peter Kille">
<meta name="dcterms.date" content="2023-09-27">

<title>Genome Visualisation and Annotation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>
    .quarto-title-block .quarto-title-banner {
      background: darkred;
    }
    </style>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Genome Visualisation and Annotation</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title d-none d-lg-block">Genome Visualisation and Annotation</h1>
            <p class="subtitle lead">Layering information onto your sequences</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Prof Peter Kille </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 27, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Session 0. HPC and Personal Cloud</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introduction to Big Data Biology and Bioinformatics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Personal_Cloud.html" class="sidebar-item-text sidebar-link">Personal Cloud</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Session 1. Linux: The basics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction to Linux.html" class="sidebar-item-text sidebar-link">Introduction to Linux</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_Linux_fundermentals.html" class="sidebar-item-text sidebar-link">Linux the fundementals</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Commandline_Tools_and_Scripting.html" class="sidebar-item-text sidebar-link">Commandline Tools and Scripting</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Session 2. NGS data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NGS_Quality_Control.html" class="sidebar-item-text sidebar-link">Session 1 - NGS Quality Control</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./genome_assembly.html" class="sidebar-item-text sidebar-link">Genome Assembly</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Session 3. Genomics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Genome_visualisation_and_annotation.html" class="sidebar-item-text sidebar-link active">Genome Visualisation and Annotation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hybrid_assemblies.html" class="sidebar-item-text sidebar-link">Hybrid Assemblies</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Session 4. Building phylogenies</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./phylogentics_phylogenomics.html" class="sidebar-item-text sidebar-link">Phylogenomics and Phylogeneomics</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Session 5. Transcriptomics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Transcriptomics_Introduction.html" class="sidebar-item-text sidebar-link">Transcritomics An Introduction</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RNAseq_processing.html" class="sidebar-item-text sidebar-link">RNAseq Processing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DEG_analysis.html" class="sidebar-item-text sidebar-link">Differential Gene Expression Analysis</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DEG_Functional_Interpretation.html" class="sidebar-item-text sidebar-link">DEG Functional Interpretation</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Session 6. Microbial community analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./metabarcoding.html" class="sidebar-item-text sidebar-link">Metagenomics</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#requirements" id="toc-requirements" class="nav-link active" data-scroll-target="#requirements">Requirements</a>
  <ul class="collapse">
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#software" id="toc-software" class="nav-link" data-scroll-target="#software">Software</a></li>
  </ul></li>
  <li><a href="#artemis" id="toc-artemis" class="nav-link" data-scroll-target="#artemis">Artemis</a>
  <ul class="collapse">
  <li><a href="#data-1" id="toc-data-1" class="nav-link" data-scroll-target="#data-1">Data</a></li>
  <li><a href="#software-1" id="toc-software-1" class="nav-link" data-scroll-target="#software-1">Software</a></li>
  <li><a href="#workshop" id="toc-workshop" class="nav-link" data-scroll-target="#workshop">Workshop</a></li>
  <li><a href="#excercises" id="toc-excercises" class="nav-link" data-scroll-target="#excercises">Excercises</a></li>
  </ul></li>
  <li><a href="#igv" id="toc-igv" class="nav-link" data-scroll-target="#igv">IGV</a>
  <ul class="collapse">
  <li><a href="#data-2" id="toc-data-2" class="nav-link" data-scroll-target="#data-2">Data</a></li>
  <li><a href="#software-2" id="toc-software-2" class="nav-link" data-scroll-target="#software-2">Software</a></li>
  <li><a href="#workshop-1" id="toc-workshop-1" class="nav-link" data-scroll-target="#workshop-1">Workshop</a></li>
  <li><a href="#excercise" id="toc-excercise" class="nav-link" data-scroll-target="#excercise">Excercise</a></li>
  </ul></li>
  <li><a href="#minimap2" id="toc-minimap2" class="nav-link" data-scroll-target="#minimap2">minimap2</a>
  <ul class="collapse">
  <li><a href="#data-3" id="toc-data-3" class="nav-link" data-scroll-target="#data-3">Data</a></li>
  <li><a href="#software-3" id="toc-software-3" class="nav-link" data-scroll-target="#software-3">Software</a></li>
  <li><a href="#workshop-2" id="toc-workshop-2" class="nav-link" data-scroll-target="#workshop-2">Workshop</a></li>
  </ul></li>
  <li><a href="#prokka" id="toc-prokka" class="nav-link" data-scroll-target="#prokka">Prokka</a>
  <ul class="collapse">
  <li><a href="#data-4" id="toc-data-4" class="nav-link" data-scroll-target="#data-4">Data</a></li>
  <li><a href="#software-4" id="toc-software-4" class="nav-link" data-scroll-target="#software-4">Software</a></li>
  <li><a href="#workshop-3" id="toc-workshop-3" class="nav-link" data-scroll-target="#workshop-3">Workshop</a>
  <ul class="collapse">
  <li><a href="#prokka-1" id="toc-prokka-1" class="nav-link" data-scroll-target="#prokka-1">Prokka</a></li>
  </ul></li>
  <li><a href="#prokka-loop" id="toc-prokka-loop" class="nav-link" data-scroll-target="#prokka-loop">Prokka Loop</a>
  <ul class="collapse">
  <li><a href="#barrnap---basic-rapid-ribosomal-rna-predictor" id="toc-barrnap---basic-rapid-ribosomal-rna-predictor" class="nav-link" data-scroll-target="#barrnap---basic-rapid-ribosomal-rna-predictor">BARRNAP - BASIC RAPID RIBOSOMAL RNA PREDICTOR</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#mitos2" id="toc-mitos2" class="nav-link" data-scroll-target="#mitos2">Mitos2</a>
  <ul class="collapse">
  <li><a href="#data-5" id="toc-data-5" class="nav-link" data-scroll-target="#data-5">Data</a></li>
  <li><a href="#software-5" id="toc-software-5" class="nav-link" data-scroll-target="#software-5">Software</a></li>
  <li><a href="#workshop-4" id="toc-workshop-4" class="nav-link" data-scroll-target="#workshop-4">Workshop</a>
  <ul class="collapse">
  <li><a href="#extract-largest-contig" id="toc-extract-largest-contig" class="nav-link" data-scroll-target="#extract-largest-contig">Extract largest contig</a></li>
  <li><a href="#annotate-with-mitos2" id="toc-annotate-with-mitos2" class="nav-link" data-scroll-target="#annotate-with-mitos2">Annotate with MITOS2</a></li>
  </ul></li>
  <li><a href="#worked-mitoss-loop-example" id="toc-worked-mitoss-loop-example" class="nav-link" data-scroll-target="#worked-mitoss-loop-example">Worked Mitoss Loop example</a>
  <ul class="collapse">
  <li><a href="#extract-fasta-sequence-for-genes-in-bed-file" id="toc-extract-fasta-sequence-for-genes-in-bed-file" class="nav-link" data-scroll-target="#extract-fasta-sequence-for-genes-in-bed-file">Extract Fasta sequence for genes in Bed file</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#ncbi-blast" id="toc-ncbi-blast" class="nav-link" data-scroll-target="#ncbi-blast">NCBI Blast+</a>
  <ul class="collapse">
  <li><a href="#data-6" id="toc-data-6" class="nav-link" data-scroll-target="#data-6">Data</a></li>
  <li><a href="#software-6" id="toc-software-6" class="nav-link" data-scroll-target="#software-6">Software</a></li>
  <li><a href="#anatomy-of-the-blast-command" id="toc-anatomy-of-the-blast-command" class="nav-link" data-scroll-target="#anatomy-of-the-blast-command">Anatomy of the BLAST command</a></li>
  <li><a href="#blast-programs" id="toc-blast-programs" class="nav-link" data-scroll-target="#blast-programs">BLAST Programs</a></li>
  <li><a href="#blast-databases" id="toc-blast-databases" class="nav-link" data-scroll-target="#blast-databases">BLAST Databases</a></li>
  <li><a href="#command-line-options" id="toc-command-line-options" class="nav-link" data-scroll-target="#command-line-options">Command line options</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<iframe data-external="1" src="https://cardiff.cloud.panopto.eu/Panopto/Pages/Embed.aspx?id=35fe879e-58e9-4141-a49a-af630098dee1&amp;autoplay=false&amp;offerviewer=true&amp;showtitle=true&amp;showbrand=true&amp;captions=false&amp;interactivity=all" height="405" width="720" style="border: 1px solid #464646;" allowfullscreen="" allow="autoplay">
</iframe>
<p><a href="https://tinyurl.com/5d4kdk49">Genome Visualisation Powerpoint</a></p>
<section id="requirements" class="level1">
<h1>Requirements</h1>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<p>The data you will need for this exercise are:</p>
<ol type="1">
<li>example genbank or embl files</li>
<li>fastq file (pair end or single end data)</li>
<li>fasta file representing assembly of data from (1)</li>
</ol>
</section>
<section id="software" class="level2">
<h2 class="anchored" data-anchor-id="software">Software</h2>
<p>Graphics software (https://sponsa.bios.cf.ac.uk/guacamole/ or install local)</p>
<ol type="1">
<li>Artemis</li>
<li>IGV</li>
</ol>
<p>Server command line modules (use command <code>module avail</code> to check versions):</p>
<ol start="3" type="1">
<li>minimap2</li>
<li>prokka</li>
<li>mitos2</li>
<li>NCBI Blast+</li>
</ol>
</section>
</section>
<section id="artemis" class="level1">
<h1>Artemis</h1>
<section id="data-1" class="level2">
<h2 class="anchored" data-anchor-id="data-1">Data</h2>
<ol type="1">
<li>Example genbank or embl files</li>
</ol>
</section>
<section id="software-1" class="level2">
<h2 class="anchored" data-anchor-id="software-1">Software</h2>
<p><a href="https://www.sanger.ac.uk/tool/artemis/">Artemis</a></p>
<p><strong><em>This can be installed locally <a href="http://sanger-pathogens.github.io/Artemis/">local install instructions</a> Warning this can take time please do not do it during teaching session.</em></strong></p>
<p>If you are installing Artemis on a Mac you will need to first install Java Java SE 15.0.2 which can be downloaded from <a href="https://www.techspot.com/downloads/5552-java-15-jdk.html">TechSpot</a>. Then you can Install <a href="http://sanger-pathogens.github.io/Artemis/Artemis/">Artemis Software dm</a>.</p>
<p>Additional sanger center traning material can be downloaded using the following link - <a href="https://tinyurl.com/4dzbj9nk">Sanger center traning</a></p>
<p>We are going to use Artemis using the VNC access to your Linux desktop - go to https://sponsa.bios.cf.ac.uk/guacamole/ and login using your university credentials.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/guacamole_new_open.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
<p>Start Terminal</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Open_Xfce_terminal.png" class="img-fluid figure-img" style="width:20.0%"></p>
</figure>
</div>
<p>Now Load Artemis Module and initiate Artemis with command <code>art</code></p>
<pre><code>module load artemis/18.2.0
art</code></pre>
<p>Artemis Opening Screen</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Artemis_Open_window.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</section>
<section id="workshop" class="level2">
<h2 class="anchored" data-anchor-id="workshop">Workshop</h2>
<p>Open Genbank File</p>
<pre><code>&gt;File &gt;Open</code></pre>
<p>Navigate to your Session3 folder and select the genbank file (<code>NC_003428.gb</code>).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Select_Genbank_file.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
<p>Cancel any warnings you should see the following window;</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Artemis_genbank_file_wrong_codon_table.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
<p>The blue highlighted area should highlight open reading frames (ORFs) and the vertical lines stop codons - notice that there are vertical line in the middle of ORFs this indicates that we are using the wrong codon table. Arrange your graphics windows so you can see the Opening window which will be hidden behind the gene display window - you should see something like this.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Art_open_window_gene_window.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
<p>Now change the codon table by selecting</p>
<pre><code>&gt; Options &gt; Genetic Code Tables
selecet
Vertebrate Mitochondrial</code></pre>
<p>Your gene visualisation should now look like this</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Artemis_genbank_file_correct_codon_table.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</section>
<section id="excercises" class="level2">
<h2 class="anchored" data-anchor-id="excercises">Excercises</h2>
<p>As we look at creating are own annotation you will be able to visual the various outputs using Artemis.</p>
<p>I have included a range of extension exercises / guides generated by Sanger center (the people to wrote Artemis) these are included in you Session Folder under <code>Artemis_Sanger_Center</code></p>
</section>
</section>
<section id="igv" class="level1">
<h1>IGV</h1>
<section id="data-2" class="level2">
<h2 class="anchored" data-anchor-id="data-2">Data</h2>
<ol type="1">
<li>Example genbank or embl files</li>
</ol>
</section>
<section id="software-2" class="level2">
<h2 class="anchored" data-anchor-id="software-2">Software</h2>
<p>[Integrative Genomics Viewer](https://software.broadinstitute.org/software/igv/) can be <a href="https://software.broadinstitute.org/software/igv/download">IGV local</a> - Warning this can take time please do not do it during teaching session].</p>
<p>We are going to use Artemis using the VNC access to your Linux desktop - go to https://sponsa.bios.cf.ac.uk/guacamole/ and login using your university credentials.</p>
<p>Guacamole Opening Screen</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/guacamole_new_open.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
<p>Start Terminal</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Open_Xfce_terminal.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
<p>Now Load IGV Module and initiate Artemis with command <code>igv.sh</code></p>
<pre><code>module load module load igv/2.12.3
igv.sh</code></pre>
<p>IVG Opening Screen</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IGV_opeing_Screen.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</section>
<section id="workshop-1" class="level2">
<h2 class="anchored" data-anchor-id="workshop-1">Workshop</h2>
<p>Now open the GenBank file using Genomes</p>
<pre><code>&gt; Genomes &gt; Load Genome from File</code></pre>
<p>Select GenBank file using file browser - you should see the following image</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IGV_GenBank_File.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</section>
<section id="excercise" class="level2">
<h2 class="anchored" data-anchor-id="excercise">Excercise</h2>
<p>As you generate annotations - look to see how you can overlay them into IVG and also try and visualise the whole bacterial genome and its prokka annotation.</p>
</section>
</section>
<section id="minimap2" class="level1">
<h1>minimap2</h1>
<section id="data-3" class="level2">
<h2 class="anchored" data-anchor-id="data-3">Data</h2>
<ol type="1">
<li>fastq file (pair end or single end data)</li>
<li>fasta file representing assembly of data from (1)</li>
</ol>
</section>
<section id="software-3" class="level2">
<h2 class="anchored" data-anchor-id="software-3">Software</h2>
<p>(Minimap - mapping software)[https://github.com/lh3/minimap2]</p>
<pre><code>module load minimap2/2.14</code></pre>
<p>Samtools - bam/sam tools utilities (for alignment files)</p>
<pre><code>module load samtools/1.15.1</code></pre>
</section>
<section id="workshop-2" class="level2">
<h2 class="anchored" data-anchor-id="workshop-2">Workshop</h2>
<p>Align sequences to your assemblies and convert to Bam file</p>
<pre><code>minimap2 -ax sr [your contigs.fasta] [forward_read.fastq] [reverse_read.fastq] &gt; aln.sam
samtools view -b -S aln.sam &gt; aln.bam
samtools sort aln.bam &gt; aln_sorted.bam
samtools index aln_sorted.bam</code></pre>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Excersise Minimap
</div>
</div>
<div class="callout-body-container callout-body">
<p>Overlay the bam file you have generated into your assembly contig using Artemis and IGV</p>
</div>
</div>
</section>
</section>
<section id="prokka" class="level1">
<h1>Prokka</h1>
<section id="data-4" class="level2">
<h2 class="anchored" data-anchor-id="data-4">Data</h2>
<ol type="1">
<li>Sequence reads and assembled genomes (contigs.fasta)</li>
</ol>
</section>
<section id="software-4" class="level2">
<h2 class="anchored" data-anchor-id="software-4">Software</h2>
<p><a href="https://github.com/tseemann/prokka">PROKKA git hub site</a></p>
<pre><code>module load prooka</code></pre>
<p><strong><em>check installed version with <code>module avail</code></em></strong></p>
</section>
<section id="workshop-3" class="level2">
<h2 class="anchored" data-anchor-id="workshop-3">Workshop</h2>
<section id="prokka-1" class="level3">
<h3 class="anchored" data-anchor-id="prokka-1">Prokka</h3>
<p>Summary: Prokka is a piece of software that is designed to identify genes from sequence data. It works on prokaryotes. Once it identifies genes, it creates a file including the sequence for the sample, along with a set of annotations to that sequence, which identify the locations of genes.</p>
<p>Basic commands / usage: To run prokka on an assembly (with an example filename of ‘contigs.fa’ use the command:</p>
<pre><code>module load prokka_mambaforge/1.14.6
prokka contigs.fa</code></pre>
<p>If you want to view the names of output files, you need to provide a name for the files and a directory where they should be saved:</p>
<p>Choose the names of the output files with –outdir and –prefix</p>
<pre><code>module load prokka_mambaforge/1.14.6
prokka --outdir mydir --prefix mygenome contigs.fa</code></pre>
<p>NOTE: Prokka defaults to analysing Bacteria. Think about what your sample is and what translation table you should use (This is also important for Artemis!). If you’re working on mitochondria include –kingdom mito and the relevant –gcodeSome examples:</p>
<pre><code>1.  The Standard Code
2.  The Vertebrate Mitochondrial Code
3.  The Yeast Mitochondrial Code
4.  The Invertebrate Mitochondrial Code
5.  The Echinoderm and Flatworm Mitochondrial Code</code></pre>
<p>A full command for mitochondrial annotation would look like this:</p>
<pre><code>module load prokka_mambaforge/1.14.6p

prokka --outdir prokka --kingdom Mitochondria --gcode 2 assembly/contigs.fasta</code></pre>
</section>
</section>
<section id="prokka-loop" class="level2">
<h2 class="anchored" data-anchor-id="prokka-loop">Prokka Loop</h2>
<iframe data-external="1" src="https://cardiff.cloud.panopto.eu/Panopto/Pages/Embed.aspx?id=4fb71dc3-818c-4317-ab92-af6a0141efbd&amp;autoplay=false&amp;offerviewer=true&amp;showtitle=true&amp;showbrand=true&amp;captions=false&amp;interactivity=all" height="405" width="720" style="border: 1px solid #464646;" allowfullscreen="" allow="autoplay">
</iframe>
<section id="barrnap---basic-rapid-ribosomal-rna-predictor" class="level3">
<h3 class="anchored" data-anchor-id="barrnap---basic-rapid-ribosomal-rna-predictor">BARRNAP - BASIC RAPID RIBOSOMAL RNA PREDICTOR</h3>
<p>[BARNAP Github](https://github.com/tseemann/barrnap)</p>
<p>Summary: Barrnap predicts the location of ribosomal RNA genes in genomes. It supports bacteria (5S,23S,16S), archaea (5S,5.8S,23S,16S), metazoan mitochondria (12S,16S) and eukaryotes (5S,5.8S,28S,18S).</p>
<p>It takes FASTA DNA sequence as input, and write GFF3 as output. It uses the new NHMMER tool that comes with HMMER 3.1 for HMM searching in RNA:DNA style. NHMMER binaries for 64-bit Linux and Mac OS X are included and will be auto-detected. Multithreading is supported and one can expect roughly linear speed-ups with more CPUs.</p>
<p>Basic command Usage:</p>
<pre><code>module load barrnap/0.8
barrnap [options] Your_contigs.fasta &gt; outfile.gff
Options:
--help            This help
--version         Print version and exit
--citation        Print citation for referencing barrnap
--kingdom [X]     Kingdom: arc mito euk bac (default 'bac')
--quiet           No screen output (default OFF)
--threads [N]     Number of threads/cores/CPUs to use (default '8')
--lencutoff [n.n] Proportional length threshold to label as partial (default '0.8')
--reject [n.n]    Proportional length threshold to reject prediction (default '0.5')
--evalue [n.n]    Similarity e-value cut-off (default '1e-06')
--incseq          Include FASTA input sequences in GFF3 output (default OFF)</code></pre>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Barnap exercises
</div>
</div>
<div class="callout-body-container callout-body">
<section id="exercise-1running-prokka-and-checking-annotations" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1running-prokka-and-checking-annotations">Exercise 1:Running PROKKA and checking Annotations</h3>
<p>Take your assembled mitochondrial genome, assemble it and run Prokka to annotate the genome. When you have done your visualization introduction you can open this in Artemis.</p>
<p>What do you see as you move along the genome? Are there regions where genes should be that Prokka has not annotated? How would you work out if a gene should be there?</p>
</section>
<section id="exercise-2-find-ribosomal-sequences" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2-find-ribosomal-sequences">Exercise 2: Find Ribosomal Sequences</h3>
<p>Use barrnap to generate a GFF file predicting the position of any ribosomal sequences – remember to customize the ‘Kingdom’ parameter to reflect the source of the sequence you are using.</p>
</section>
</div>
</div>
</section>
</section>
</section>
<section id="mitos2" class="level1">
<h1>Mitos2</h1>
<section id="data-5" class="level2">
<h2 class="anchored" data-anchor-id="data-5">Data</h2>
<ol type="1">
<li>Use the assembled contig from your last session (contigs.fasta)</li>
</ol>
</section>
<section id="software-5" class="level2">
<h2 class="anchored" data-anchor-id="software-5">Software</h2>
<p>[mitos2 source](https://gitlab.com/Bernt/MITOS), [mitos browser version](http://mitos2.bioinf.uni-leipzig.de/)</p>
<pre><code>module load mitos/2.0.4</code></pre>
<p>bioperl-live/release-1-7-2</p>
<pre><code>module load bioperl-live/release-1-7-2</code></pre>
<p>selectSeqsAboveMinLength</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>    <span class="ex">~/classdata/Bioinformatics/REFS/script/selectSeqsAboveMinLength.pl</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>bedtools</p>
<pre><code>module load bedtools2/2.30.0</code></pre>
</section>
<section id="workshop-4" class="level2">
<h2 class="anchored" data-anchor-id="workshop-4">Workshop</h2>
<section id="extract-largest-contig" class="level3">
<h3 class="anchored" data-anchor-id="extract-largest-contig">Extract largest contig</h3>
<p>Use loop to extract out your longest contig - if single contig no need to perform this step</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> load bioperl-live/release-1-7-2</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">3</span><span class="dt">}</span><span class="kw">;</span><span class="cf">do</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">perl</span> ~/classdata/Bioinformatics/REFS/script/selectSeqsAboveMinLength.pl <span class="op">&lt;</span>your_assembly.fasta<span class="op">&gt;</span> <span class="op">&lt;</span>largest_contig.fasta<span class="op">&gt;</span> 8000</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="annotate-with-mitos2" class="level3">
<h3 class="anchored" data-anchor-id="annotate-with-mitos2">Annotate with MITOS2</h3>
<p>MITOS is a web server for the automatic annotation of metazoan mitochondrial genomes. MITOS allows a reliable and consistent annotation of proteins and non-coding RNAs. The analysis steps are as follows:</p>
<p>• Candidate protein coding genes are found by detecting congruences in the results of blastx searches against the amino acid sequences of the annotated proteins of metazoan mitochondrial genomes found in the NCBI RefSeq 81. A postprocessing step detects start and stop codons, duplicates, and hits belonging to the same transcript, e.g.&nbsp;frame shift or splicing.</p>
<p>• tRNAs are annotated using MITFI, i.e.&nbsp;novel structure-based covariance models as described in Jühling, et al.&nbsp;Nucleic Acids Research, 2012, 40(7):2833-2845. This approach was shown to have an unmatched sensitivity (outperforming ARWEN and tRNAscan-SE, respectively) and a precision higher than ARWEN and equivalent to tRNAscan-SE.</p>
<p>• rRNA annotation is performed using structure-based covariance # models that have been developed similarly to the tRNA models. Structural considerations improve 5’ and 3’ end predictions of the rRNAs.</p>
<p>• In a final step, conflicts are resolved and the outcome is prepared for visualization.</p>
<p>NB ensure you create you output folder before you run mitos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> mitos_annot</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="ex">runmitos.py</span>  <span class="at">-i</span> contigs.fasta <span class="at">-c</span> 2 <span class="at">-o</span> mitos_annot <span class="at">-R</span> ~/classdata/Bioinformatics/REFS/mitos/ <span class="at">-r</span> refseq81m <span class="at">--rrna</span> 0 <span class="at">--trna</span> 0 <span class="at">--intron</span> 0 <span class="at">--debug</span> <span class="at">--noplot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>loop would be something like this</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="va">workdir</span><span class="op">=</span>~/mydata/Session3/</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> load mitos/2.0.4</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">3</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> grp<span class="va">${i}</span>_mitos_annot</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="ex">runmitos.py</span> <span class="at">-i</span> <span class="st">"</span><span class="va">${workdir}</span><span class="st">/group</span><span class="va">${i}</span><span class="st">_unknown_cetacean_assembly.fasta"</span> <span class="dt">\</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">-c</span> 2 <span class="dt">\</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">-o</span> grp<span class="va">${i}</span>_mitos_annot <span class="dt">\</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">-R</span> ~/classdata/Bioinformatics/REFS/mitos/ <span class="dt">\</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">-r</span> refseq81m <span class="dt">\</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">--rrna</span> 0 <span class="dt">\</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">--trna</span> 0 <span class="dt">\</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">--intron</span> 0 <span class="dt">\</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">--debug</span> <span class="dt">\</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">--noplot</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> unload mitos/2.0.4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="worked-mitoss-loop-example" class="level2">
<h2 class="anchored" data-anchor-id="worked-mitoss-loop-example">Worked Mitoss Loop example</h2>
<iframe data-external="1" src="https://cardiff.cloud.panopto.eu/Panopto/Pages/Embed.aspx?id=257ce45d-7a81-4c25-91b8-af6a01422c39&amp;autoplay=false&amp;offerviewer=true&amp;showtitle=true&amp;showbrand=true&amp;captions=false&amp;interactivity=all" height="405" width="720" style="border: 1px solid #464646;" allowfullscreen="" allow="autoplay">
</iframe>
<section id="extract-fasta-sequence-for-genes-in-bed-file" class="level3">
<h3 class="anchored" data-anchor-id="extract-fasta-sequence-for-genes-in-bed-file">Extract Fasta sequence for genes in Bed file</h3>
<p>You can extract the fasta sequence for the genes in the bed file using bedtools getfasta:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> load bedtools2/2.30.0</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="ex">bedtools</span> getfasta –fi contigs.fasta <span class="at">-bed</span> result.bed <span class="at">-name</span> <span class="op">&gt;</span>result.fasta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Or using a loop</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">3</span><span class="dt">}</span><span class="kw">;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="ex">bedtools</span> getfasta <span class="at">-fi</span> spades_output_<span class="va">${i}</span>/before_rr.fasta <span class="at">-bed</span> mitos_<span class="va">${i}</span>/result.bed <span class="at">-name</span> <span class="op">&gt;</span>mitos_<span class="va">${i}</span>_result.fasta</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
mitos2 Excersises
</div>
</div>
<div class="callout-body-container callout-body">
<p>We will now annotate your genome using mitos:</p>
<ol type="1">
<li><p>Use seqtk seq to select only the largest contig into a new file</p></li>
<li><p>Use mitos to annotate the contig, and visualize it with Artemis</p></li>
<li><p>Create a loop to generate the output for all canidiea assembiles</p></li>
<li><p>[Extension] Use the BEDtools to extract the sequence of the annotated genes</p></li>
<li><p>[Extension] Use seqtk to extract just the COX1 gene</p></li>
</ol>
</div>
</div>
</section>
</section>
</section>
<section id="ncbi-blast" class="level1">
<h1>NCBI Blast+</h1>
<section id="data-6" class="level2">
<h2 class="anchored" data-anchor-id="data-6">Data</h2>
<ol type="1">
<li>Use the assembled contig from your last session (contigs.fasta)</li>
<li>Blast Databases, Location:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>    <span class="ex">~/classdata/Bioinformatics/REFS/blastdb/</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="ex">swissprot</span> <span class="at">--</span> uniprot protein database <span class="er">(</span><span class="ex">Uniprot</span> <span class="at">--</span> annotated protein database<span class="kw">)</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="ex">mito_pro</span> <span class="at">--</span> metazoan mitochondrial database </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="ex">16S_ribosomal_RNA</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="ex">16S</span> ribosomal database</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="software-6" class="level2">
<h2 class="anchored" data-anchor-id="software-6">Software</h2>
<p><a href="https://blast.ncbi.nlm.nih.gov/Blast.cgi">NCBI Blast+ suite available</a> Don’t forget to load the blast and any other modules you need!</p>
<pre><code>module load blast-plus/2.12.0</code></pre>
</section>
<section id="anatomy-of-the-blast-command" class="level2">
<h2 class="anchored" data-anchor-id="anatomy-of-the-blast-command">Anatomy of the BLAST command</h2>
<p>A basic blast command states your reference database that has been constructed, your query, and an output file: <code>blastx –db /home/db/fish –query contigs.fasta –out contigs_blx.txt</code> This uses blastx to match DNA query against protein database. Targets the protein database stored at /home/db/ that’s named ‘fish’. Blast using contig.fasta file and puts the output in contig_blx.txt</p>
</section>
<section id="blast-programs" class="level2">
<h2 class="anchored" data-anchor-id="blast-programs">BLAST Programs</h2>
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th>Program</th>
<th style="text-align: right;">Input-Output</th>
<th style="text-align: right;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>blastn</td>
<td style="text-align: right;">nucleotide-nucleotide</td>
<td style="text-align: right;">This program, given a DNA query, returns the most similar DNA sequences from the DNA database that the user specifies.</td>
</tr>
<tr class="even">
<td>blastp</td>
<td style="text-align: right;">protein-protein</td>
<td style="text-align: right;">This program, given a protein query, returns the most similar protein sequences from the protein database that the user specifies.</td>
</tr>
<tr class="odd">
<td>blastx</td>
<td style="text-align: right;">nucleotide</td>
<td style="text-align: right;">6-frame translation-protein This program compares the six-frame conceptual translation products of a nucleotide query sequence (both strands) against a protein sequence database.</td>
</tr>
<tr class="even">
<td>tblastx</td>
<td style="text-align: right;">nucleotide</td>
<td style="text-align: right;">6-frame translation-nucleotide 6-frame translation This program is the slowest of the BLAST family. It translates the query nucleotide sequence in all six possible frames and compares it against the six-frame translations of a nucleotide sequence database. The purpose of tblastx is to find very distant relationships between nucleotide sequences.</td>
</tr>
<tr class="odd">
<td>tblastn</td>
<td style="text-align: right;">protein-nucleotide</td>
<td style="text-align: right;">6-frame translation This program compares a protein query against the all six reading frames of a nucleotide sequence database.</td>
</tr>
<tr class="even">
<td>psi-blast</td>
<td style="text-align: right;">position-specific</td>
<td style="text-align: right;">This program is used to find distant relatives of a protein. First, a list of all closely related proteins is created. These proteins are combined into a general “profile” sequence, which summarises significant features present in these sequences. A query against the protein database is then run using this profile, and a larger group of proteins is found. This larger group is used to construct another profile, and the process is repeated. By including related proteins in the search, PSI-BLAST is much more sensitive in picking up distant evolutionary relationships than a standard protein-protein BLAST.</td>
</tr>
<tr class="odd">
<td>megablast</td>
<td style="text-align: right;">large queries seqs</td>
<td style="text-align: right;">When comparing large numbers of input sequences via the command-line BLAST, “megablast” is much faster than running BLAST multiple times. It concatenates many input sequences together to form a large sequence before searching the BLAST database, then post-analyze the search results to glean individual alignments and statistical values</td>
</tr>
</tbody>
</table>
</section>
<section id="blast-databases" class="level2">
<h2 class="anchored" data-anchor-id="blast-databases">BLAST Databases</h2>
<p>Currently installed are:</p>
<p>• swissprot – uniprot protein database (Uniprot – annotated protein database) • mito_pro – metazoan mitochondrial database • 16S_ribosomal_RNA – 16S ribosomal database • hum_mt_pep – human mitochondrial</p>
<p>You already have the databases you require today but for reference it is at location</p>
<pre><code> ~/classdata/Bioinformatics/REFS/blastdb/</code></pre>
<p>To create blast databases use the makeblastdb. To create a new database:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>    <span class="ex">makeblastdb</span> <span class="at">-in</span> nucleotide_seq.fa –dbtype nucl –title my_db <span class="at">-out</span> my_seq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="command-line-options" class="level2">
<h2 class="anchored" data-anchor-id="command-line-options">Command line options</h2>
<pre><code>-in         [input_file] 
-dbtype     [molecule_type], nucl – nucleotide or prot - protein
-title  [database_title]
-out        [database_name]</code></pre>
<p>OTHER OPTIONS</p>
<pre><code>  blastn [-h] [-help] [-import_search_strategy filename]
    [-export_search_strategy filename] [-task task_name] [-db database_name]
    [-dbsize num_letters] [-gilist filename] [-seqidlist filename]
    [-negative_gilist filename] [-negative_seqidlist filename]
    [-taxids taxids] [-negative_taxids taxids] [-taxidlist filename]
    [-negative_taxidlist filename] [-entrez_query entrez_query]
    [-db_soft_mask filtering_algorithm] [-db_hard_mask filtering_algorithm]
    [-subject subject_input_file] [-subject_loc range] [-query input_file]
    [-out output_file] [-evalue evalue] [-word_size int_value]
    [-gapopen open_penalty] [-gapextend extend_penalty]
    [-perc_identity float_value] [-qcov_hsp_perc float_value]
    [-max_hsps int_value] [-xdrop_ungap float_value] [-xdrop_gap float_value]
    [-xdrop_gap_final float_value] [-searchsp int_value] [-penalty penalty]
    [-reward reward] [-no_greedy] [-min_raw_gapped_score int_value]
    [-template_type type] [-template_length int_value] [-dust DUST_options]
    [-filtering_db filtering_database]
    [-window_masker_taxid window_masker_taxid]
    [-window_masker_db window_masker_db] [-soft_masking soft_masking]
    [-ungapped] [-culling_limit int_value] [-best_hit_overhang float_value]
    [-best_hit_score_edge float_value] [-subject_besthit]
    [-window_size int_value] [-off_diagonal_range int_value]
    [-use_index boolean] [-index_name string] [-lcase_masking]
    [-query_loc range] [-strand strand] [-parse_deflines] [-outfmt format]
    [-show_gis] [-num_descriptions int_value] [-num_alignments int_value]
    [-line_length line_length] [-html] [-sorthits sort_hits]
    [-sorthsps sort_hsps] [-max_target_seqs num_sequences]
    [-num_threads int_value] [-remote] [-version]</code></pre>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Exercises: Annotate your mitochondria
</div>
</div>
<div class="callout-body-container callout-body">
<p>Take your assembled mitochondrial genome and identify mitochondrial orthologues using blast.</p>
<ol type="1">
<li><p>Perform blastx analysis of your sequence against the mitochondrial protein database. Interrogate the using ‘less’.</p></li>
<li><p>Re-run the blastx analysis with the output format parameter set to a cutomised <code>-outfmt 6</code>, which will output the data into a tablular format compatible with Artemis.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>    <span class="ex">blastx</span> <span class="at">-query</span> [contigs.fasta] <span class="at">-db</span> ~/classdata/Bioinformatics/REFS/blastdb/hum_mt_pep <span class="at">-out</span> [output.txt] <span class="at">-outfmt</span> <span class="st">"6 qseqid sseqid pident length mismatch gapopen sstart send qstart qend evalue bitscore"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can now open the fasta sequence you have used in the blast with Artemis and then overlay with the clast output file.</p>
<ol start="3" type="1">
<li><p>Repeat the blastx analysis of your sequence against the mitochondrial protein database [mito_pro] only returning blast matches with an E value lower that 1E-10 and using all 4 threads.</p></li>
<li><p>Repeat the blastx analysis of your sequence against the mitochondrial protein database, only returning blast matches with an E value lower that 1E-10, using all 4 threads, limiting the outputs so that you keep to 100 and putting the outputs into the tabular format compatible with Artemis.</p></li>
<li><p>[Extension] Produce a loop to annotate all assembled contigs using blast</p></li>
<li><p>[Extension] You can try repeating this exercise with swisprot and note the differences</p></li>
</ol>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>