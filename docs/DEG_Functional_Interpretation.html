<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Prof Peter Kille">
<meta name="dcterms.date" content="2023-01-04">

<title>DEG Functional Interpretation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>
    .quarto-title-block .quarto-title-banner {
      background: darkred;
    }
    </style>
<link href="site_libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet">


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">DEG Functional Interpretation</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title d-none d-lg-block">DEG Functional Interpretation</h1>
            <p class="subtitle lead">From Gene Lists to Biological Meansing</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Prof Peter Kille </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 4, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Introduction</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introduction to Big Data Biology and Bioinformatics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Personal_Cloud.html" class="sidebar-item-text sidebar-link">Personal Cloud</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Linux Basics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction to Linux.html" class="sidebar-item-text sidebar-link">Session 1 - Introduction to Linux</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_Linux_fundermentals.html" class="sidebar-item-text sidebar-link">Linux the fundementals</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Commandline_Tools_and_Scripting.html" class="sidebar-item-text sidebar-link">Commandline Tools and Scripting</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">NGS Quality Control</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NGS_Quality_Control.html" class="sidebar-item-text sidebar-link">Session 1 - NGS Quality Control</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Genome Assembly and annotations</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./genome_assembly.html" class="sidebar-item-text sidebar-link">Genome Assembly</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hybrid_assemblies.html" class="sidebar-item-text sidebar-link">Hybrid Assemblies</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Genome_visualisation_and_annotation.html" class="sidebar-item-text sidebar-link">Genome Visualisation and Annotation</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Phylogenetics and Phylogenomics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./phylogentics_phylogenomics.html" class="sidebar-item-text sidebar-link">Phylogenomics and Phylogeneomics</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Metabarcoding</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./metabarcoding.html" class="sidebar-item-text sidebar-link">Metagenomics</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Transcriptomics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Transcriptomics_Introduction.html" class="sidebar-item-text sidebar-link">Transcritomics An Introduction</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RNAseq_processing.html" class="sidebar-item-text sidebar-link">RNAseq Processing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DEG_analysis.html" class="sidebar-item-text sidebar-link">Differential Gene Expression Analysis</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DEG_Functional_Interpretation.html" class="sidebar-item-text sidebar-link active">DEG Functional Interpretation</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#workshop-overview" id="toc-workshop-overview" class="nav-link active" data-scroll-target="#workshop-overview">Workshop Overview</a>
  <ul class="collapse">
  <li><a href="#processing-rnaseq-data" id="toc-processing-rnaseq-data" class="nav-link" data-scroll-target="#processing-rnaseq-data">Processing RNAseq Data</a></li>
  <li><a href="#dataset-to-use---geogds2565" id="toc-dataset-to-use---geogds2565" class="nav-link" data-scroll-target="#dataset-to-use---geogds2565">Dataset to use - Geo:GDS2565</a></li>
  <li><a href="#panopto_walk_through" id="toc-panopto_walk_through" class="nav-link" data-scroll-target="#panopto_walk_through">Panopto_walk_through</a></li>
  </ul></li>
  <li><a href="#key-statistical-concepts" id="toc-key-statistical-concepts" class="nav-link" data-scroll-target="#key-statistical-concepts">Key Statistical Concepts</a>
  <ul class="collapse">
  <li><a href="#false-discover-rate" id="toc-false-discover-rate" class="nav-link" data-scroll-target="#false-discover-rate">False Discover Rate</a></li>
  <li><a href="#fishers-exact-test-and-enrichment-analysis" id="toc-fishers-exact-test-and-enrichment-analysis" class="nav-link" data-scroll-target="#fishers-exact-test-and-enrichment-analysis">Fisher’s Exact Test and Enrichment Analysis</a></li>
  </ul></li>
  <li><a href="#mining-geo-database" id="toc-mining-geo-database" class="nav-link" data-scroll-target="#mining-geo-database">Mining GEO database</a>
  <ul class="collapse">
  <li><a href="#geo-workshop" id="toc-geo-workshop" class="nav-link" data-scroll-target="#geo-workshop">Geo Workshop</a></li>
  <li><a href="#geo-database-panopto" id="toc-geo-database-panopto" class="nav-link" data-scroll-target="#geo-database-panopto">GEO Database Panopto</a></li>
  </ul></li>
  <li><a href="#enrichment-analysis---gprofiler" id="toc-enrichment-analysis---gprofiler" class="nav-link" data-scroll-target="#enrichment-analysis---gprofiler">Enrichment Analysis - gprofiler</a>
  <ul class="collapse">
  <li><a href="#gprofiler-panopto" id="toc-gprofiler-panopto" class="nav-link" data-scroll-target="#gprofiler-panopto">gprofiler panopto</a></li>
  </ul></li>
  <li><a href="#database-for-annotation-visualization-and-integrated-discovery---david" id="toc-database-for-annotation-visualization-and-integrated-discovery---david" class="nav-link" data-scroll-target="#database-for-annotation-visualization-and-integrated-discovery---david">Database for Annotation, Visualization and Integrated Discovery - DAVID</a>
  <ul class="collapse">
  <li><a href="#gene-enrichment-analysis-with-david" id="toc-gene-enrichment-analysis-with-david" class="nav-link" data-scroll-target="#gene-enrichment-analysis-with-david">Gene Enrichment Analysis with David</a></li>
  <li><a href="#start-analysis-and-upload-you-data" id="toc-start-analysis-and-upload-you-data" class="nav-link" data-scroll-target="#start-analysis-and-upload-you-data">1. Start analysis and upload you data</a></li>
  <li><a href="#generate-functional-analysis-of-gene-list" id="toc-generate-functional-analysis-of-gene-list" class="nav-link" data-scroll-target="#generate-functional-analysis-of-gene-list">2. Generate Functional Analysis of gene list</a></li>
  <li><a href="#review-gene-ontology-enrichment" id="toc-review-gene-ontology-enrichment" class="nav-link" data-scroll-target="#review-gene-ontology-enrichment">3. Review Gene Ontology Enrichment</a></li>
  <li><a href="#pathway-analysis" id="toc-pathway-analysis" class="nav-link" data-scroll-target="#pathway-analysis">4. Pathway analysis</a></li>
  <li><a href="#functional-annotation-clustering" id="toc-functional-annotation-clustering" class="nav-link" data-scroll-target="#functional-annotation-clustering">5. Functional Annotation Clustering</a></li>
  </ul></li>
  <li><a href="#string" id="toc-string" class="nav-link" data-scroll-target="#string">STRING</a>
  <ul class="collapse">
  <li><a href="#string-panopto" id="toc-string-panopto" class="nav-link" data-scroll-target="#string-panopto">STRING Panopto</a></li>
  </ul></li>
  <li><a href="#semantic-similarity-with-revigo" id="toc-semantic-similarity-with-revigo" class="nav-link" data-scroll-target="#semantic-similarity-with-revigo">Semantic similarity with Revigo</a>
  <ul class="collapse">
  <li><a href="#export-go-terms-and-p-values" id="toc-export-go-terms-and-p-values" class="nav-link" data-scroll-target="#export-go-terms-and-p-values">1. Export GO terms and P-values</a>
  <ul class="collapse">
  <li><a href="#a.-gprofiler" id="toc-a.-gprofiler" class="nav-link" data-scroll-target="#a.-gprofiler">1A. gprofiler</a></li>
  <li><a href="#b.-david" id="toc-b.-david" class="nav-link" data-scroll-target="#b.-david">1B. DAVID</a></li>
  </ul></li>
  <li><a href="#revigo-data-entry" id="toc-revigo-data-entry" class="nav-link" data-scroll-target="#revigo-data-entry">2. Revigo data entry</a></li>
  <li><a href="#review-revigo-results" id="toc-review-revigo-results" class="nav-link" data-scroll-target="#review-revigo-results">3. Review Revigo Results</a></li>
  <li><a href="#revigo-workshop" id="toc-revigo-workshop" class="nav-link" data-scroll-target="#revigo-workshop">Revigo Workshop</a></li>
  <li><a href="#revigo-panopto" id="toc-revigo-panopto" class="nav-link" data-scroll-target="#revigo-panopto">Revigo Panopto</a></li>
  </ul></li>
  <li><a href="#other-tools" id="toc-other-tools" class="nav-link" data-scroll-target="#other-tools">Other Tools</a>
  <ul class="collapse">
  <li><a href="#venn-diagram-maker---venn" id="toc-venn-diagram-maker---venn" class="nav-link" data-scroll-target="#venn-diagram-maker---venn">Venn Diagram Maker - Venn</a></li>
  <li><a href="#divenny-diagram---intersections-showing-up-and-down-regulation" id="toc-divenny-diagram---intersections-showing-up-and-down-regulation" class="nav-link" data-scroll-target="#divenny-diagram---intersections-showing-up-and-down-regulation">Divenny Diagram - intersections showing up and down regulation</a></li>
  <li><a href="#pathway-analysis---gonet" id="toc-pathway-analysis---gonet" class="nav-link" data-scroll-target="#pathway-analysis---gonet">Pathway analysis - GOnet</a></li>
  <li><a href="#genecard---gene-function-repository" id="toc-genecard---gene-function-repository" class="nav-link" data-scroll-target="#genecard---gene-function-repository">GeneCard - Gene function repository</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>Workshop Recording to come</p>
<section id="workshop-overview" class="level1">
<h1>Workshop Overview</h1>
<section id="processing-rnaseq-data" class="level2">
<h2 class="anchored" data-anchor-id="processing-rnaseq-data">Processing RNAseq Data</h2>
<p>Converting RNASeq data into gene counts is the first-step prior to analysis of the biological function and networks revealed through the subsequent transcription analysis. This process is outside the scope of this workshop but if you are interested <a href="https://cf.sharepoint.com/:b:/t/SystemsBiology/EQ_8U8YJ9i9Fg0bKPo6PmO4Bec8KxoXp6zIco-L5z-_55g?e=Hme6hj0">Andres et al 2013</a> Provides an excellent overview of the processes involved.</p>
<p><img src="images/Process_Overview.png" class="img-fluid" alt="Process Overview"> Figure 1. Process overview</p>
</section>
<section id="dataset-to-use---geogds2565" class="level2">
<h2 class="anchored" data-anchor-id="dataset-to-use---geogds2565"><a href="https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS2565">Dataset to use - Geo:GDS2565</a></h2>
</section>
<section id="panopto_walk_through" class="level2">
<h2 class="anchored" data-anchor-id="panopto_walk_through"><a href="https://cardiff.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=9d81b942-6a9a-42e5-8fd8-ac7401144342">Panopto_walk_through</a></h2>
</section>
</section>
<section id="key-statistical-concepts" class="level1">
<h1>Key Statistical Concepts</h1>
<p>The workshop will use tools that exploit statistical approaches to identify differential expressed genes (DEGs) and subsequently identify the biological pathways or processes that are over represented (some time refereed to as enriched) within the DEGs. You will not need to derive the mathematical formula underpinning these concepts or deploy the algorithums from first principles since the software you will use does this for you but it is worth knowing the background. There is an excellent academic from Stanford University Name Prof Josh Starmer who runs a youtube channel called <a href="https://www.youtube.com/channel/UCtYLUTtgS3k1Fg4y5tAhLbw">StatQuest</a> this deal with a large range of biological stats and has some great annotations to explain them, I am going to suggest you watch two of his videos to orientate you about the key statistical concepts for this session:</p>
<section id="false-discover-rate" class="level2">
<h2 class="anchored" data-anchor-id="false-discover-rate">False Discover Rate</h2>
<div class="cell">
<div class="cell-output-display">
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/K8LQSvtjcEo?start=404" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
</div>
</section>
<section id="fishers-exact-test-and-enrichment-analysis" class="level2">
<h2 class="anchored" data-anchor-id="fishers-exact-test-and-enrichment-analysis">Fisher’s Exact Test and Enrichment Analysis</h2>
<div class="cell">
<div class="cell-output-display">
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/udyAvvaMjfM" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="mining-geo-database" class="level1">
<h1>Mining GEO database</h1>
<section id="geo-workshop" class="level2">
<h2 class="anchored" data-anchor-id="geo-workshop"><a href="https://cf.sharepoint.com/:b:/t/SystemsBiology/ESRyTPUlb_dJgpHLXUbYk2wBO_SyL9gXhOXOs-BpHFSPsw?e=FXrOLC">Geo Workshop</a></h2>
<ol type="1">
<li>Search for you dataset</li>
</ol>
<p>Go to Geo DataSets: (https://www.ncbi.nlm.nih.gov/gds/)[https://www.ncbi.nlm.nih.gov/gds/]</p>
<p><img src="images/GEO_DataSets.png" class="img-fluid" alt="GEO_DataSet Search"> <strong><em>GEO_DataSet Search</em></strong></p>
<p>now select <search></search></p>
<ol start="2" type="1">
<li>Refine search to only show ‘DataSets’ and ‘Series’</li>
</ol>
<p>Select <strong><em>&lt; DataSets and Series &gt;</em></strong> from the left hand menu.</p>
<p><img src="images/DataSet_Selection.png" class="img-fluid" alt="Refine to DataSets"> <strong><em>Refine to DataSets</em></strong></p>
<p>3A. Select procesed dataset (should be number 3 in list and have a heat map icon to the right)</p>
<p>Click on title <strong><em>&lt; Endothelial cell response to ultrafine particles &gt;</em></strong> to select DataSet</p>
<p><img src="images/GDS2565.png" class="img-fluid" alt="Entry Page"> <strong><em>Entry Page</em></strong></p>
<p>Take notes off all pertinent information about the experiment, including species and what microarray platform was used. In this case experiment was conducted on rats and analysed on an Affymetrix Human Genome U133 Plus 2.0 Array. Download any publication available. Also, if you are interested you could have a look at the cluster analysis on the right hand site. This will show you how the relationship of the expression profiles from each sample relative to each other. If the experiment was successful, all samples of a certain treatment should cluster together.</p>
<p>4A. Compare experiment samples</p>
<p>Click <strong><em>&lt;Compare 2 sets of sample&gt;</em></strong></p>
<p>Choose <strong><em>&lt;test e.g.&nbsp;One-tailed t-test (A &gt; B)&gt;</em></strong></p>
<p>Choose <significance level="">_ e.g.&nbsp;0.001</significance></p>
<p>Click on: Step 2: Select which Samples to put in Group A and Group B</p>
<p><img src="images/group_compare.png" class="img-fluid" alt="Select Groups to Comnpare"> <strong><em>Select Groups to compare</em></strong></p>
<p>Choose <strong><em>&lt; Query Group A vs B &gt;</em></strong></p>
<p>You should now see a list of the following DEGS</p>
<p><img src="images/DEGs.png" class="img-fluid" alt="DEG list"> <strong><em>DEG List</em></strong></p>
<p>5A. Download DEGs</p>
<p>You have &gt;100 DEGs but the page only displays the first 20. Before downloading DEGS change the items per page from 20 to 500.</p>
<p><img src="images/Items_per_page.png" class="img-fluid" alt="Items Per Page"> <strong><em>Items Per Page</em></strong></p>
<p>Select <strong><em>&lt; Download profile data &gt;</em></strong></p>
<p>and you will be prompted to save the profiling of the DEGs displayed as default file name <strong><em>&lt;profile_data.txt&gt;</em></strong></p>
<p>Save to appropriate location. If needed Select Page 2…. of the DEGS and repeat the download process.</p>
<p>Repeat this process for <strong><em>&lt;test e.g.&nbsp;One-tailed t-test (B &gt; A) significance level 0.001 &gt;</em></strong>_</p>
<p>6A. Open and Merge DEG lists in Excel</p>
<p>The DEG lists show the gene list with there relative expression level (normalised) and annotation for the genes involved (annotation shown in columns BG -&gt;). For Our next steps we will use the Gene symbol that is in Column BH.</p>
<p>3B. Select un-processed series (should be number 2 - it will have icon <strong><em>&lt; Analyze with GEO2R &gt;</em></strong> at the end of the entry)</p>
<p>Click on <strong><em>&lt; Analyze with GEO2R &gt;</em></strong></p>
<p>Now Define groups by click clicking the <strong><em>&lt; Define Group pull &gt;</em></strong> down and create groups ‘control’ and ‘Treatment’ (enter group name and press enter). Click on each sample in list and associated it with one of your group (you can hold ctrl down to select multiple entry before associating them with the group).</p>
<p><img src="images/compare_groups_geo2R.png" class="img-fluid" alt="Select Groups to Compare"> <strong><em>Select Groups to compare</em></strong></p>
<p>4B. Customise the Option and Analyse</p>
<p>Select <strong><em>&lt; Options &gt;</em></strong> and customise as shown below:</p>
<p><img src="images/Geo2R_Options.png" class="img-fluid" alt="Geo2R Options"> <strong><em>Geo2R Options</em></strong></p>
<p>Select <strong><em>&lt; reanalyze &gt;</em></strong></p>
<p>Will will now see a Processing icon - this may take a minute or two.</p>
<p>5B. DEGs</p>
<p>You will now see a table and a series of Visualisations - review the visualisation taking note of what each are showing you.</p>
<p><img src="images/GEO2R_results.png" class="img-fluid" alt="Geo2R results"> <strong><em>Geo2R results</em></strong></p>
<p>Venn diagram showing GSE4567: Limma, Padj&lt;0.05 - 704 genes - this is the set we will use</p>
<p>Click on <strong><em>&lt; Explore and download, control vs treatment and Download Significant genes &gt;</em></strong></p>
<p>This will give you a Tsv you can open in excel</p>
<p>6B DEG TSV</p>
<p>Open the DEG TSV - you will have ID (Affymetrix), Gene Symbol, Description and Log2(fold Change) and Adjusted p-value. The Gene.symbol can have multiple symonyms for each gene - this can bias future analsyis. Copy/paste gene symbol column to rught hand column (so no other data is on right), and use <strong><em>&lt; Data &gt; Text to Columns &gt; Delimited &gt; Other &gt; ‘/’ &gt; Finish &gt;</em></strong>_ to push secondary symbols into other columns.</p>
</section>
<section id="geo-database-panopto" class="level2">
<h2 class="anchored" data-anchor-id="geo-database-panopto"><a href="https://cardiff.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=fc9e75dd-2cad-4c45-9c90-ab6b00bf41e2">GEO Database Panopto</a></h2>
</section>
</section>
<section id="enrichment-analysis---gprofiler" class="level1">
<h1>Enrichment Analysis - gprofiler</h1>
<p><a href="https://biit.cs.ut.ee/gprofiler/gost">gprofiler</a> provide a great tool for performing enrichment analysis, it also has associated tools for ID conversations and Orthology searching. As well as interrogating enrichment for (Gene Ontology)[http://geneontology.org/] terms and pathways (it uses (reactome)[https://reactome.org/] it also exploits physical position linked properties such as transcription factor binding sites and miRNSA binding to provide additional evidence of linkages between DEGs. Another function that is exceptionally useful is the ability to provided two gene lists and compare the enrichment side-by-side. To do this place ‘&gt; title of list 1’ before the first list and ‘&gt; title of list 2’ (and so on for as many list as you want) before submitting your enrichment analysis <strong><em>Note</em></strong> the essential element is the ‘&gt;’ sign but also remember to select <strong><em>&lt; Run as multiquery &gt;</em></strong> if you want this option..</p>
<ol type="1">
<li>Load you DEG list</li>
</ol>
<p>Paste you DEG list into the box and click on <strong><em>&lt; Run query &gt;</em></strong> (I suggest you select Benjamin-Hochberg FDR under Advanced options)</p>
<p><img src="images/gprofiler_upload.png" class="img-fluid" alt="gprofiler upload data"> <strong><em>gprofiler upload data</em></strong></p>
<p>You may be asked if you wish to confirm gene identified - if you are accept the selected options.</p>
<ol start="2" type="1">
<li>Review Enrichment</li>
</ol>
<p>You will be presented with and enrichment summary.</p>
<p><img src="images/Enrichment_summary.png" class="img-fluid" alt="Enrichment Summary"> <strong><em>Enrichment Summary</em></strong></p>
<p>Here the y-axis is -log10(adjPValue) - so the larger the number the more improbably the functional representation is there by random. The size of the symbols represent the number of genes in each category.</p>
<p>Now select <strong><em>&lt; Detailed Results &gt;</em></strong> this is a tab that is displayed about halfway down the page</p>
<p><img src="images/gprofiler_detailed_results.png" class="img-fluid" alt="gprofiler detailed results"> <strong><em>gprofiler detailed results</em></strong></p>
<p>Note:</p>
<p>Adjusted p-value if give next to each term</p>
<p>Top of the detailed results page there is ‘CSV’ option to download the data into a spreadsheet format.</p>
<ol start="3" type="1">
<li>Consider the Transcription Factor enrichment.</li>
</ol>
<p>Gene regulation is at the heart of DEGs - co-regulated gene should should have direct or indirect regulatory network moderated through conserved transcription factor binding sites.</p>
<p><img src="images/TF_enrichment.png" class="img-fluid" alt="Transcription Factor enrichment"> <strong><em>Transcription Factor enrichment</em></strong></p>
<section id="gprofiler-panopto" class="level2">
<h2 class="anchored" data-anchor-id="gprofiler-panopto"><a href="https://cardiff.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=5cebe4ce-805f-4d72-bf17-ab6b01103ae5">gprofiler panopto</a></h2>
</section>
</section>
<section id="database-for-annotation-visualization-and-integrated-discovery---david" class="level1">
<h1>Database for Annotation, Visualization and Integrated Discovery - DAVID</h1>
<p>David Web site - https://david.ncifcrf.gov/</p>
<section id="gene-enrichment-analysis-with-david" class="level2">
<h2 class="anchored" data-anchor-id="gene-enrichment-analysis-with-david">Gene Enrichment Analysis with David</h2>
<p>[David - Database for Annotation, Visualization and Integrated Discovery] (https://david.ncifcrf.gov/) was the tool to use for gene enrichment from 2005 - 2016 but the database it hosted became out of date due to a break in the research groups funding. From 2016 (gprofiler)[https://biit.cs.ut.ee/gprofiler/gost] and (stringdb)[https://string-db.org/] have been prefered because they have been kept upto date. However, DAVID was refunded and a 2021 update means it is back to being maintained. Although there will not be time to explore it in our workshop the following workshop and video is there to support anyone wanting to explore its functionality.</p>
</section>
<section id="start-analysis-and-upload-you-data" class="level2">
<h2 class="anchored" data-anchor-id="start-analysis-and-upload-you-data">1. Start analysis and upload you data</h2>
<p>Select <strong><em>&lt; start analysis &gt;</em></strong></p>
<p>Paste in you gene list (1) in box (A) and, select identifier (2), and identify as a Gene List (3). Select your species (2a) . In more nuanced analysis you may wish to define your own background - this is useful when working with non-model organisms or if your starting population does not represent the entire genome.</p>
<p><img src="images/david_upload.png" class="img-fluid" alt="DAVID Upload"> <strong><em>DAVID Upload</em></strong></p>
<p>now select <strong><em>&lt; Submit List &gt;</em></strong></p>
</section>
<section id="generate-functional-analysis-of-gene-list" class="level2">
<h2 class="anchored" data-anchor-id="generate-functional-analysis-of-gene-list">2. Generate Functional Analysis of gene list</h2>
<p>If you have used a non-regulate gene identifier or it does not recognize the identifier type you have used it may ask you to convert the identifiers - check the programs suggestion - it is usually good but you should check.</p>
<p>Select <strong><em>&lt; Functional Annotation Tool &gt;</em></strong></p>
<p>You will now be give a annotation summary as shown below:</p>
<p><img src="images/david_annotation_summary.png" class="img-fluid" alt="Annotation Summary"> <strong><em>Annotation Summary</em></strong></p>
<p>You will see a range of categories for which the functional annotation has been performed. The analysis told has not only cross referenced the gene list against a range of functional databases it has also analysed the gene co-appearance in citations (Literature), links to disease (Disease) and Interactions agonist other linkages.</p>
</section>
<section id="review-gene-ontology-enrichment" class="level2">
<h2 class="anchored" data-anchor-id="review-gene-ontology-enrichment">3. Review Gene Ontology Enrichment</h2>
<p>Let us consider the functional enrichment using (Gene Ontology)[http://geneontology.org/]. Gene Ontology categorizes gene products using three distinct characteristics - Molecular Function (biochemistry of the product), Cellular Component (where it appears in the cell), and the Biological Processes - see more about these classification by reviewing the (Gene Ontology Overview documentation)[http://geneontology.org/docs/ontology-documentation/]. Although ontologies are hierarchical, they are not a simple classification system, they not only allow for gene products to be involved with multiple processes the relationship between elements in the hierarchy are closely defined. The ontology also allows for classification to be as specific or detailed as knowledge allows ie if a protein is a transporter but what it transports is not known it will be defined by a mid-level term ‘transporter’ but if it is known to transport Zn it will be classified at a ‘Zinc transport’ as well as a ‘transporter’. Enrichment analysis uses fisher exact test (see about) to calculate the enrichment at each of these ‘levels’ - although I usually choose to look at the integrated data summarized under the ‘GOTERM_[BP/CC/MF]_DIRECT’.</p>
<p>click on the + next too the <strong><em>&lt; Gene_Ontology &gt;</em></strong> category</p>
<p>Select <strong><em>&lt; Chart &gt;</em></strong> right of the GOTERM_BP_DIRECT</p>
<p><img src="images/David_BP_enrichment.png" class="img-fluid" alt="BP Enrichment"> <strong><em>BP Enrichment</em></strong></p>
<p>Note the P-value and benjamini correct p-value displaying the like hood that those specific Go terms are represented by random - i.e.&nbsp;lost the P-value the less likely the representation of the term is a random select , therefore the more likely the term is enriched.</p>
<p>To see the list of gene involved in for instance ‘positive regulation of osteoblast differentiation’ click on the blue bar under the ‘Genes’ column.</p>
<p>This is the list you will see:</p>
<p><img src="images/osteoblast_differentiation.png" class="img-fluid" alt="positive regulation of osteoblast differentiation"> <strong><em>positive regulation of osteoblast differentiation</em></strong></p>
<p>Now review enrichment for Cell Component and Molecular Function.</p>
</section>
<section id="pathway-analysis" class="level2">
<h2 class="anchored" data-anchor-id="pathway-analysis">4. Pathway analysis</h2>
<p>click on the + next too the <strong><em>&lt; Pathways &gt;</em></strong> category</p>
<p><img src="images/David_pathways.png" class="img-fluid" alt="Pathway Options"> <strong><em>Pathway Options</em></strong></p>
<p>Select <strong><em>&lt; Chart &gt;</em></strong> right of the KEGG</p>
<p><img src="images/Kegg_enrichment.png" class="img-fluid" alt="KEGG Enrichment"> <strong><em>KEGG Enrichment</em></strong></p>
<p>You will see a list of enriched pathways - Note the P-value and benjamini correct p-value displaying the like hood that those specific pathways are represented by random - i.e.&nbsp;lost the P-value the less likely the representation of the pathway is a random select, therefore the more likely the pathways is enriched.</p>
<p>click on the <strong><em>&lt; TNF Signalling Pathway &gt;</em></strong>_ in the term column</p>
<p>This will display the pathway with the terms that are present in the list shown with red stars or highlight by redtext below the figure.</p>
<p><img src="images/TNF.png" class="img-fluid" alt="TNF Signalling Pathway"> <strong><em>TNF Signalling Pathway</em></strong></p>
<p>Explore some more pathways</p>
</section>
<section id="functional-annotation-clustering" class="level2">
<h2 class="anchored" data-anchor-id="functional-annotation-clustering">5. Functional Annotation Clustering</h2>
<p>DAVID attempts to summarise enrichment between categorization systems using a tool it terms - Functional annotation clustering. If you select this for you current data set. you will be provided with the following clusters:</p>
<p><img src="images/Functional_Annotation_Clustering.png" class="img-fluid" alt="Functional Annotation Clustering"> <strong><em>Functional Annotation Clustering</em></strong></p>
<p>Each cluster is assigned an enrichment score under which ‘terms’ that are enriched under different classification systems are displayed grouped together. Each ‘grouping’ is given a ‘Enrichment Score’ the larger the enrichment score the higher the score the more likely that cluster is being enriched. Note that the is a ‘Classification Stringency’ pull down menu that allows you to define the strength of associated of the term being grouped together.</p>
<p>For annotation Cluster 6 (which contains lots of Metallothionein/cadimum associated terms) there is a small green and black box - after the Enrichment Score and the ‘G’ - click on this box. This brings up a cluster matrix showing the gene gene products on the Y-axis and the classification ‘vlasses’ on the X-axis.</p>
<p><img src="images/cluster_matrix.png" class="img-fluid" alt="cluster matrix"> <strong><em>Cluster Matrix</em></strong></p>
<p><a href="https://cf.sharepoint.com/:b:/t/SystemsBiology/EREU-YiocCJGum6A7Nn6AJIBU0G6bvJtdrUy5m6Ba5yspg?e=M9l56F">David Workshop</a></p>
<section id="enrichment-with-david-panopto" class="level4">
<h4 class="anchored" data-anchor-id="enrichment-with-david-panopto"><a href="https://cardiff.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=e714981c-6144-49f5-9d24-ab6b00d22977">Enrichment with David Panopto</a></h4>
</section>
</section>
</section>
<section id="string" class="level1">
<h1><a href="https://string-db.org/">STRING</a></h1>
<ol type="1">
<li>Login to String-db</li>
</ol>
<p>Open String-db and login using an appropriate account</p>
<ol start="2" type="1">
<li>Upload your data</li>
</ol>
<p>Select <strong><em>&lt; My data &gt;</em></strong> from top menu</p>
<p>Select <strong><em>&lt; create new gene set &gt;</em></strong> under <strong><em>&lt; Your stored gene sets &gt;</em></strong></p>
<p>Give you Gene List a Name, select Homo sapiens as species and past in your gene symbols</p>
<p><img src="images/String_new_gene_set.png" class="img-fluid" alt="New Gene Set in STRING-db"> <strong><em>New Gene Set in STRING-db</em></strong></p>
<p>Select <strong><em>&lt; continue &gt;</em></strong></p>
<p>if asked to review mappings <strong><em>&lt; please review the mappings … &gt;</em></strong> select continue</p>
<ol start="3" type="1">
<li>Explore Gene Enrichment</li>
</ol>
<p>Review stored Gene set and select <strong><em>&lt; analyse &gt;</em></strong></p>
<p><img src="images/Stored_gene_set.png" class="img-fluid" alt="Stored Gene Set in STRING-db"> <strong><em>Stored Gene Set in STRING-db</em></strong></p>
<p>Review Enrichment analysis</p>
<p><img src="images/String-db_enrichment.png" class="img-fluid" alt="Enrichment analysis in STRING-db"> <strong><em>Enrichment analysis in STRING-db</em></strong></p>
<ol start="4" type="1">
<li>Create you Gene Network</li>
</ol>
<p>Return to you dataset and now select <strong><em>&lt; show &gt;</em></strong></p>
<p>Select <strong><em>&lt; view as a interactive network &gt;</em></strong></p>
<p>You will now see a very large and detailed network - go to bottom on page and select settings and change to match the following settings. The select <strong><em>&lt; update &gt;</em></strong></p>
<p><img src="images/String_db_settings.png" class="img-fluid" alt="STRING-db Settings"> <strong><em>STRING-db Settings</em></strong></p>
<p>First_network</p>
<p><img src="images/First_network.png" class="img-fluid" alt="STRING-db Network"> <strong><em>STRING-db Network</em></strong></p>
<p>Now play and refine your network - try clusting using 3 clusters</p>
<section id="string-panopto" class="level2">
<h2 class="anchored" data-anchor-id="string-panopto"><a href="https://cardiff.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=edfe7653-7e16-45b0-8e1e-ac7401079592">STRING Panopto</a></h2>
</section>
</section>
<section id="semantic-similarity-with-revigo" class="level1">
<h1>Semantic similarity with Revigo</h1>
<p>Revigo can take long lists of Gene Ontology terms and summarize them by removing redundant GO terms using semantic similarity. The input you need is a list of GO terms in the format <code>GO:[NUMBER]</code> a tab and the associated p-value.</p>
<section id="export-go-terms-and-p-values" class="level2">
<h2 class="anchored" data-anchor-id="export-go-terms-and-p-values">1. Export GO terms and P-values</h2>
<section id="a.-gprofiler" class="level3">
<h3 class="anchored" data-anchor-id="a.-gprofiler">1A. gprofiler</h3>
<p>Under the detailed results menu there is a <code>CSV</code> icon which when clicked can be used to export your enriched terms as a CSV which can then be imported into excel. You can use the associated setting button (the cog symbol next toi the CSV) to select only GO terms to export for this exercise.</p>
<p><img src="images/gprofiler_export.png" class="img-fluid" alt="gprofiler export"> <strong><em>gprofiler export</em></strong></p>
<p>You will then need to copy column C and D into Revigo</p>
</section>
<section id="b.-david" class="level3">
<h3 class="anchored" data-anchor-id="b.-david">1B. DAVID</h3>
<p>After you have completed the functional analysis select <strong><em>&lt; Gene_ontology &gt; GOTERM_BP_DIRECT &gt; Chart &gt;</em></strong></p>
<p>now Select <strong><em>&lt; Download File &gt;</em></strong></p>
<p><img src="images/david_go_download.png" class="img-fluid" alt="DAVID Go Dowbload"> <strong><em>DAVID Go Download</em></strong></p>
<p>This will either display the enrichment table into the browser window or ask for a save location depending on your browser settings. If you are not asked for a save location right hand click the displayed table and select <code>Save as</code> and save to a appropriate location as a text file. This text file can be opened/imported into excel. You will file the GO term is concatenated with the GO description in Column B. To split this insert a blank column after column B, then select column B and select menu option <strong><em>&lt; Data &gt; Test to columns &gt;</em></strong>. Select <strong><em>&lt; Delimited &gt; Next &gt;</em></strong>_ and use the radio button to select <strong><em>other</em></strong> and add a <strong><em>~</em></strong>_ to the box directly to the right of this option. Now click <strong><em>&lt; Next and Finish &gt;</em></strong>. You will see the GO term in now in Column B and the P-value in column F. Select these columns and paste them into Revigo.</p>
<p>You should now repeat this process for Molecular Function and Cell Component Terms.When all the data is merged you can paste the GO term and P value into Revigo.</p>
</section>
</section>
<section id="revigo-data-entry" class="level2">
<h2 class="anchored" data-anchor-id="revigo-data-entry">2. Revigo data entry</h2>
<p>Enter GO terms and P-values into Revigo - they should be in format</p>
<pre><code>Term    PValue
GO:0045892  7.75E-06
GO:0006694  3.29E-04</code></pre>
<p>Leave the default settings and select <strong><em>&lt; Start Revigo &gt;</em></strong></p>
</section>
<section id="review-revigo-results" class="level2">
<h2 class="anchored" data-anchor-id="review-revigo-results">3. Review Revigo Results</h2>
<p>For each GO term category Revigo will generate a Scatterplot, Table, 3D scatter plot, interactive Graph and Tree Map. <strong><em>Note: at the bottom of each plot there are export options for R and other formats</em></strong> _.</p>
<p>The most intuitive format is are the Tree Maps (see below) whilst the Scatterplot output table, which include terms like ‘Frequency and Uniqueness’ can be used to create networks in Cytoscape.</p>
<p><img src="images/Revigo_BP_TreeMap.png" class="img-fluid" alt="Revigo BP TreeMap"> <strong><em>Revigo BP TreeMap</em></strong></p>
</section>
<section id="revigo-workshop" class="level2">
<h2 class="anchored" data-anchor-id="revigo-workshop"><a href="https://cf.sharepoint.com/:b:/t/SystemsBiology/EX0QBkPbAUpGoWALa5uyXFQBmvxV5yTI5aYOq3f5pI1W2w?e=cBpqbh">Revigo Workshop</a></h2>
</section>
<section id="revigo-panopto" class="level2">
<h2 class="anchored" data-anchor-id="revigo-panopto"><a href="https://cardiff.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=f3a44879-12cc-406d-bb95-ab6b00e23416">Revigo Panopto</a></h2>
</section>
</section>
<section id="other-tools" class="level1">
<h1>Other Tools</h1>
<section id="venn-diagram-maker---venn" class="level3">
<h3 class="anchored" data-anchor-id="venn-diagram-maker---venn"><a href="https://bioinfogp.cnb.csic.es/tools/venny/">Venn Diagram Maker - Venn</a></h3>
</section>
<section id="divenny-diagram---intersections-showing-up-and-down-regulation" class="level3">
<h3 class="anchored" data-anchor-id="divenny-diagram---intersections-showing-up-and-down-regulation"><a href="https://divenn.noble.org/">Divenny Diagram - intersections showing up and down regulation</a></h3>
</section>
<section id="pathway-analysis---gonet" class="level3">
<h3 class="anchored" data-anchor-id="pathway-analysis---gonet"><a href="https://tools.dice-database.org/GOnet/">Pathway analysis - GOnet</a></h3>
</section>
<section id="genecard---gene-function-repository" class="level3">
<h3 class="anchored" data-anchor-id="genecard---gene-function-repository"><a href="https://www.genecards.org/">GeneCard - Gene function repository</a></h3>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>