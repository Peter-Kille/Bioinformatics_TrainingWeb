<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr Alex Mullins">
<meta name="dcterms.date" content="2023-01-03">

<title>Phylogenomics and Phylogeneomics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>
    .quarto-title-block .quarto-title-banner {
      background: darkred;
    }
    </style>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Phylogenomics and Phylogeneomics</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title d-none d-lg-block">Phylogenomics and Phylogeneomics</h1>
            <p class="subtitle lead">Deriving phylogenies from single genes to whole genomes</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Dr Alex Mullins </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 3, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Introduction</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introduction to Big Data Biology and Bioinformatics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Personal_Cloud.html" class="sidebar-item-text sidebar-link">Personal Cloud</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Linux Basics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction to Linux.html" class="sidebar-item-text sidebar-link">Session 1 - Introduction to Linux</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_Linux_fundermentals.html" class="sidebar-item-text sidebar-link">Linux the fundementals</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Commandline_Tools_and_Scripting.html" class="sidebar-item-text sidebar-link">Commandline Tools and Scripting</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">NGS Quality Control</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NGS_Quality_Control.html" class="sidebar-item-text sidebar-link">Session 1 - NGS Quality Control</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Genome Assembly and annotations</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./genome_assembly.html" class="sidebar-item-text sidebar-link">Genome Assembly</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hybrid_assemblies.html" class="sidebar-item-text sidebar-link">Hybrid Assemblies</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Genome_visualisation_and_annotation.html" class="sidebar-item-text sidebar-link">Genome Visualisation and Annotation</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Phylogenetics and Phylogenomics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./phylogentics_phylogenomics.html" class="sidebar-item-text sidebar-link active">Phylogenomics and Phylogeneomics</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Metabarcoding</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./metabarcoding.html" class="sidebar-item-text sidebar-link">Metagenomics</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Transcriptomics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Transcriptomics_Introduction.html" class="sidebar-item-text sidebar-link">Transcritomics An Introduction</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RNAseq_processing.html" class="sidebar-item-text sidebar-link">RNAseq Processing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DEG_analysis.html" class="sidebar-item-text sidebar-link">Differential Gene Expression Analysis</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DEG_Functional_Interpretation.html" class="sidebar-item-text sidebar-link">DEG Functional Interpretation</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#exercises-on-constructing-and-interpreting-phylogenies" id="toc-exercises-on-constructing-and-interpreting-phylogenies" class="nav-link" data-scroll-target="#exercises-on-constructing-and-interpreting-phylogenies"><strong>Exercises on constructing and interpreting phylogenies</strong></a></li>
  <li><a href="#single-gene-phylogeny-identify-the-unknown-cetacean" id="toc-single-gene-phylogeny-identify-the-unknown-cetacean" class="nav-link" data-scroll-target="#single-gene-phylogeny-identify-the-unknown-cetacean">Single gene phylogeny: Identify the unknown cetacean</a></li>
  <li><a href="#core-gene-phylogeny-understand-the-diversity-of-a-bacterial-species" id="toc-core-gene-phylogeny-understand-the-diversity-of-a-bacterial-species" class="nav-link" data-scroll-target="#core-gene-phylogeny-understand-the-diversity-of-a-bacterial-species">Core gene phylogeny: Understand the diversity of a bacterial species</a></li>
  <li><a href="#snp-phylogeny-determine-the-epidemiological-implications-of-the-brucella-infections" id="toc-snp-phylogeny-determine-the-epidemiological-implications-of-the-brucella-infections" class="nav-link" data-scroll-target="#snp-phylogeny-determine-the-epidemiological-implications-of-the-brucella-infections">SNP phylogeny: Determine the epidemiological implications of the <em>Brucella</em> infections</a></li>
  </ul></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#sequence-data-available-for-the-phylogeny-exercises" id="toc-sequence-data-available-for-the-phylogeny-exercises" class="nav-link" data-scroll-target="#sequence-data-available-for-the-phylogeny-exercises"><strong>Sequence data available for the phylogeny exercises</strong></a>
  <ul class="collapse">
  <li><a href="#single-gene-phylogeny" id="toc-single-gene-phylogeny" class="nav-link" data-scroll-target="#single-gene-phylogeny">Single Gene Phylogeny</a></li>
  <li><a href="#core-gene-phylogeny" id="toc-core-gene-phylogeny" class="nav-link" data-scroll-target="#core-gene-phylogeny">Core Gene Phylogeny</a></li>
  <li><a href="#snp-phylogeny" id="toc-snp-phylogeny" class="nav-link" data-scroll-target="#snp-phylogeny">SNP Phylogeny</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#tools-and-usage" id="toc-tools-and-usage" class="nav-link" data-scroll-target="#tools-and-usage">Tools and Usage</a>
  <ul class="collapse">
  <li><a href="#bioinformatic-software-and-tools" id="toc-bioinformatic-software-and-tools" class="nav-link" data-scroll-target="#bioinformatic-software-and-tools"><strong>Bioinformatic software and tools</strong></a></li>
  <li><a href="#software-usage" id="toc-software-usage" class="nav-link" data-scroll-target="#software-usage">Software usage</a>
  <ul class="collapse">
  <li><a href="#prokka" id="toc-prokka" class="nav-link" data-scroll-target="#prokka">Prokka</a></li>
  <li><a href="#barrnap" id="toc-barrnap" class="nav-link" data-scroll-target="#barrnap">Barrnap</a></li>
  <li><a href="#bedtools" id="toc-bedtools" class="nav-link" data-scroll-target="#bedtools">Bedtools</a></li>
  <li><a href="#mafft" id="toc-mafft" class="nav-link" data-scroll-target="#mafft">MAFFT</a></li>
  <li><a href="#raxml-ng" id="toc-raxml-ng" class="nav-link" data-scroll-target="#raxml-ng">RAxML-NG</a></li>
  <li><a href="#panaroo" id="toc-panaroo" class="nav-link" data-scroll-target="#panaroo">panaroo</a></li>
  <li><a href="#snippy" id="toc-snippy" class="nav-link" data-scroll-target="#snippy">snippy</a></li>
  <li><a href="#figtree" id="toc-figtree" class="nav-link" data-scroll-target="#figtree">Figtree</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#walk-throughs" id="toc-walk-throughs" class="nav-link" data-scroll-target="#walk-throughs">Walk throughs</a>
  <ul class="collapse">
  <li><a href="#single-gene" id="toc-single-gene" class="nav-link" data-scroll-target="#single-gene">Single Gene</a></li>
  <li><a href="#whole-genome-snp" id="toc-whole-genome-snp" class="nav-link" data-scroll-target="#whole-genome-snp">Whole Genome SNP</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<iframe data-external="1" src="https://cardiff.cloud.panopto.eu/Panopto/Pages/Embed.aspx?id=7996f42d-c454-4329-8235-af630098de06&amp;autoplay=false&amp;offerviewer=true&amp;showtitle=true&amp;showbrand=true&amp;captions=false&amp;interactivity=all" height="405" width="720" style="border: 1px solid #464646;" allowfullscreen="" allow="autoplay">
</iframe>
<p><a href="https://tinyurl.com/2jv8jphr">Phylogenetics to phylogenomics Powerpoint</a></p>
<p><a href="https://goo.gl/BMzU8p">Online Phylogenetic Lecture</a></p>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<section id="exercises-on-constructing-and-interpreting-phylogenies" class="level2">
<h2 class="anchored" data-anchor-id="exercises-on-constructing-and-interpreting-phylogenies"><strong>Exercises on constructing and interpreting phylogenies</strong></h2>
<p>Below are three scenarios that require you to process sequence data to produce single gene, core gene, and SNP phylogenies. Remember that we are processing the sequence data to obtain <strong>biological interpretations</strong>. Don’t get lost in the terminal with typing commands meaninglessly, step back and think about the bioinformatic process to get to the end goal.</p>
<p><br></p>
</section>
<section id="single-gene-phylogeny-identify-the-unknown-cetacean" class="level2">
<h2 class="anchored" data-anchor-id="single-gene-phylogeny-identify-the-unknown-cetacean">Single gene phylogeny: Identify the unknown cetacean</h2>
<p>For conservation purposes, you will identify the unknown species of cetacean spotted off the coast of Madagascar. To identify the unknown cetacean and understand its relationship to other cetaceans, you will construct a 16S rRNA gene phylogeny with known representatives.</p>
<p><br></p>
<ol type="1">
<li>Use NCBI Genbank or the European Nucleotide Archive online to download the platypus mitochondrial genome and upload to your virtual machine. The platypus genome will function as an outgroup.</li>
<li>Use <strong>Prokka</strong> or <strong>Barrnap</strong> to annotate both your assembled mitochondrial genome and the platypus mitochondrial genome, and extract the 16S rRNA gene using <strong>bedtools</strong></li>
<li>Use <strong>MAFFT</strong> to create an alignment of 16S rRNA genes that includes 16S rRNA genes from your assembled mitochondrial genome, platypus mitochondrial genome, and the provided reverence 16S rRNA sequences.</li>
<li>Construct a phylogeny with <strong>RAxML-NG</strong></li>
</ol>
<p><br></p>
<p>What species is the unknown cetacean?<br>
Do you notice any unexpected evolutionary relationships? Elephant, hippopotamus, narwhal?</p>
<p><br></p>
</section>
<section id="core-gene-phylogeny-understand-the-diversity-of-a-bacterial-species" class="level2">
<h2 class="anchored" data-anchor-id="core-gene-phylogeny-understand-the-diversity-of-a-bacterial-species">Core gene phylogeny: Understand the diversity of a bacterial species</h2>
<p><em>Bacillus velezensis</em> is a known plant growth promoting and biopesticidal bacterium that benefits crops. A collaborator has sequenced multiple strains of this bacterium and asked you to analyse the genomes. You will construct a core gene phylogeny of the genome collection provided to understand the diversity of the species.</p>
<p><br></p>
<ol type="1">
<li>Identify a suitable outgroup for this phylogeny (closely related species) – look back at the lecture to understand outgrouping in core genome phylogenies. Download a suitable genome from NCBI Genbank or the European Nucleotide Archive and upload to your virtual machine.</li>
<li>Annotate the <em>B. velezensis</em> genomes using <strong>Prokka</strong>.</li>
<li>Predict the pangenome and construct a core gene alignment by processing the gff annotation files with <strong>panaroo</strong>.</li>
<li>Construct a phylogeny with <strong>RAxML-NG</strong>.</li>
</ol>
<p><br></p>
<p>If you were to repeat this analysis without the designated outgroup, which strain/s would be the outgroup of the phylogeny? (check lecture for guidance).</p>
<p><br></p>
</section>
<section id="snp-phylogeny-determine-the-epidemiological-implications-of-the-brucella-infections" class="level2">
<h2 class="anchored" data-anchor-id="snp-phylogeny-determine-the-epidemiological-implications-of-the-brucella-infections">SNP phylogeny: Determine the epidemiological implications of the <em>Brucella</em> infections</h2>
<p><em>Brucella</em> are bacteria of clinical importance as they have bioterrosism potential due to their low infectious dose and possibility of aerosolisation allowing rapid and wide dispersion. Two cases of brucellosis (disease caused by <em>Brucella</em>) have been identified in the USA, and the bacterial isolates sequenced. Construct a SNP-based phylogeny to identify the <em>Brucella</em> species, determine the possible geographical origin of the isolates, and implications for epidemiology.</p>
<p><br></p>
<ol type="1">
<li>Look at the <strong>characterised</strong> <em>Brucella</em> sequence data provided. Based on the species present (e.g.&nbsp;<em>canis</em>), choose a <strong>different</strong> closely related species to act as an outgroup and reference. Use NCBI Genbank or the European Nucleotide Archive online to download a suitable outgroup/reference genome and upload to your virtual machine.</li>
<li>Recall from Session2 how we need to process raw sequence data prior to use. Use <strong>Fastqc</strong> and <strong>Fastp</strong> to quality check and remove adaptors/trim poor quality bases, respectively.</li>
<li>Use <strong>snippy</strong> to identify SNPs between the reference/outgroup genome and <strong>both</strong> your processed unknown samples and processed characterised sequence data - you need to analyse both datasets (characterised and unknown) otherwise your phylogeny will look pretty sparse!</li>
<li>Use <strong>snippy-core</strong> to create an alignment of SNPs.</li>
<li>Construct a phylogeny with <strong>RAxML-NG</strong>.</li>
</ol>
<p><br></p>
<p>What can you infer from the phylogeny? Are the two isolates related? Are they the same species? Do they share a geographical origin? What are the implications for disease control? - check US Centre for Disease Control (CDC) website for guidance: https://www.cdc.gov/brucellosis/pdf/brucellosi-reference-guide.pdf</p>
</section>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<section id="sequence-data-available-for-the-phylogeny-exercises" class="level2">
<h2 class="anchored" data-anchor-id="sequence-data-available-for-the-phylogeny-exercises"><strong>Sequence data available for the phylogeny exercises</strong></h2>
<section id="single-gene-phylogeny" class="level3">
<h3 class="anchored" data-anchor-id="single-gene-phylogeny">Single Gene Phylogeny</h3>
<ul>
<li>Your assembled mitochondrial genome from Session2</li>
<li>16S_rRNA_genes - Directory containing a collection of 16S rRNA genes</li>
</ul>
<p><br></p>
</section>
<section id="core-gene-phylogeny" class="level3">
<h3 class="anchored" data-anchor-id="core-gene-phylogeny">Core Gene Phylogeny</h3>
<ul>
<li>bacillus_genomes - Directory containing assembled genomes of <em>Bacillus velezensis</em> strains</li>
</ul>
<p><br></p>
</section>
<section id="snp-phylogeny" class="level3">
<h3 class="anchored" data-anchor-id="snp-phylogeny">SNP Phylogeny</h3>
<ul>
<li>brucella_sequence_data - Containts a directory of fastq files of characterised <em>Brucella</em> isolates, and group-specific directories of unknown infection isolates</li>
</ul>
</section>
</section>
</section>
<section id="tools-and-usage" class="level1">
<h1>Tools and Usage</h1>
<section id="bioinformatic-software-and-tools" class="level2">
<h2 class="anchored" data-anchor-id="bioinformatic-software-and-tools"><strong>Bioinformatic software and tools</strong></h2>
<p>We will use multiple bioinformatic packages to extract and process the sequence data to construct phylogenies</p>
<p>Prokka – genome annotation<br>
bedtools – manipulate and extract sequences from fasta files<br>
MAFFT – sequence alignment<br>
RAxML-NG – construct phylogenies<br>
panaroo – pangenome pipeline<br>
snippy – identify sequence variants</p>
<p><br></p>
<p><strong>Remember that you can access the “help” option for almost all bioinformatics tools by executing the name of the tool with no flags/options, or adding -h or –help. After using a program, dont forget to unload the module.</strong></p>
<p><br></p>
</section>
<section id="software-usage" class="level2">
<h2 class="anchored" data-anchor-id="software-usage">Software usage</h2>
<section id="prokka" class="level3">
<h3 class="anchored" data-anchor-id="prokka">Prokka</h3>
<p>Whole genome annotation is the process of identifying features of interest in a set of genomic DNA sequences, and labelling them with useful information. Prokka is a software tool to annotate bacterial, archaeal and viral genomes quickly and produce standards-compliant output files.</p>
<pre><code>module load prokka_mambaforge/1.14.6</code></pre>
<p><br></p>
<p>Basic usage:</p>
<pre><code>prokka --prefix [output file prefix] --outdir [output directory] --cpus [cpu number] --kingdom Mitochondria [fasta file]</code></pre>
<p>Prokka outputs the annotation in multiple formats. Open the gbk and gff files to see their structure. Both are annotation files that indicate the location of genes/proteins, their sequence, and their putative function based on sequence comparisons to databases</p>
<p><br></p>
</section>
<section id="barrnap" class="level3">
<h3 class="anchored" data-anchor-id="barrnap">Barrnap</h3>
<p>BAsic Rapid Ribosomal RNA Predictor. Can be used to annotate rRNA genes in genomes.</p>
<pre><code>module load barrnap/0.8
module load hmmer/3.3.2</code></pre>
<p><br></p>
<p>Basic usage:</p>
<pre><code>barrnap --kingdom mito --threads [number of cpus] [fasta file] &gt; [output gff annotation file]</code></pre>
<p><br></p>
</section>
<section id="bedtools" class="level3">
<h3 class="anchored" data-anchor-id="bedtools">Bedtools</h3>
<p>Collectively, the bedtools utilities are a swiss-army knife of tools for a wide-range of genomics analysis tasks. The most widely-used tools enable genome arithmetic: that is, set theory on the genome. For example, bedtools allows one to intersect, merge, count, complement, and shuffle genomic intervals from multiple files in widely-used genomic file formats such as BAM, BED, GFF/GTF, VCF. While each individual tool is designed to do a relatively simple task (e.g., intersect two interval files), quite sophisticated analyses can be conducted by combining multiple bedtools operations on the UNIX command line.</p>
<pre><code>module load bedtools2/2.30.0</code></pre>
<p><br></p>
<p>We can use bedtools to extract gene/protein sequences from annotation files:</p>
<ol type="1">
<li>Navigate to either the <strong>Prokka</strong> annotation output directory or the <strong>Barrnap</strong> output file</li>
<li>Create a sub-gff file that contains the annotation information of only the 16S rRNA gene</li>
</ol>
<!-- -->
<pre><code>grep "16S" [gff annotation file]  &gt; [subset_16S.gff]</code></pre>
<ol start="3" type="1">
<li>Extract the 16S rRNA gene from the mitochondrial genome assembly using the subset_16S.gff annotation file (contains the co-ordinates for the start/stop positions). Depending on how the assembly graph was made, the sequence may be in the opposite orientation (reverse complement). To account for this we need to extract based on the strandedness using the <em>-s</em> option.</li>
</ol>
<!-- -->
<pre><code>bedtools getfasta -fi [input fasta file] -bed [subset_gff file] -s &gt; [output 16S file.fasta]</code></pre>
<ol start="4" type="1">
<li>Move your extracted 16S rRNA gene sequence into the directory of 16S rRNA reference genes provided.</li>
<li>Combine all the 16S rRNA gene fasta files into a single multifasta file</li>
</ol>
<!-- -->
<pre><code>cat [*.fasta] &gt; [output multifasta file]</code></pre>
<p><br></p>
</section>
<section id="mafft" class="level3">
<h3 class="anchored" data-anchor-id="mafft">MAFFT</h3>
<p>MAFFT is a multiple sequence alignment program for unix-like operating systems.</p>
<pre><code>module load mafft/7.481</code></pre>
<p><br></p>
<p>Basic usage:</p>
<pre><code>mafft [input multifasta] &gt; [output alignment multifasta]</code></pre>
<p><br></p>
</section>
<section id="raxml-ng" class="level3">
<h3 class="anchored" data-anchor-id="raxml-ng">RAxML-NG</h3>
<p>RAxML-NG is a phylogenetic tree inference tool which uses maximum-likelihood (ML) optimality criterion.</p>
<pre><code>module load raxml-ng/1.0.2</code></pre>
<p><br></p>
<p>RAxML-NG outputs files to your current location. Create a directory and run RAxML from the directory to keep files organised</p>
<p>Basic usage for nucleotide alignment with GTR model:</p>
<pre><code>raxml-ng-mpi --all --msa [input alignment] --model GTR --bs-tree [bootstrap replicate number e.g. 100] --prefix [prefix for output files] --threads [number of threads/cpus]</code></pre>
<p>RAxML-NG produces multiple output files. The file we are interested in has the extension <strong>.support</strong><br>
Add the extension <strong>.nwk</strong> to this file to indicate it is a phylogeny.</p>
<p><br></p>
</section>
<section id="panaroo" class="level3">
<h3 class="anchored" data-anchor-id="panaroo">panaroo</h3>
<p>A Bacterial Pangenome Analysis Pipeline. Predicts core, accessory, and pangenomes. Produces core gene alignments.</p>
<pre><code>module load panaroo/1.3.0</code></pre>
<p><br></p>
<p>Panaroo takes annotation files in <strong>.gff</strong> format to predict pangenomes.<br>
Use prokka to annotate the <em>Bacillus velezensis</em> genomes supplied, and remember to change the kingdom flag to bacteria</p>
<p>Basic usage:</p>
<pre><code>panaroo -i *gff -o [output directory] -t [number of cpus] --clean-mode sensitive -a core --aligner mafft</code></pre>
<p>Output files of interest include the <strong>summary_statistics.txt</strong> and <strong>core_gene.aln</strong><br>
</p>
<p>Check the website for details of all the files produced: https://gtonkinhill.github.io/panaroo/#/gettingstarted/output</p>
<p><br></p>
</section>
<section id="snippy" class="level3">
<h3 class="anchored" data-anchor-id="snippy">snippy</h3>
<p>A tool to identify variations between a reference genome in fasta format and genome sequence data in read format (fastq)</p>
<pre><code>module load snippy/v4.6.0</code></pre>
<p><br></p>
<p>Basic usage:</p>
<p>To identify SNPs for one genome</p>
<pre><code>snippy –outdir [output directory] -ref [reference sequence fasta] -R1 [read 1 fastq file] -R2 [read 2 fastq file] –prefix [prefix for output]</code></pre>
<p>You will need a loop to call SNPs for multiple genomes</p>
<p><br></p>
<p>To produce an alignment from SNPs, navigate to the snippy output directory and run <strong>snippy-core</strong>. The wildcard will extract the necessary SNP data from all the genomes analysed by snippy (directory for each genome in output directory).</p>
<pre><code>snippy-core –ref [same reference sequence] –prefix [prefix for output] *</code></pre>
<p><br></p>
</section>
<section id="figtree" class="level3">
<h3 class="anchored" data-anchor-id="figtree">Figtree</h3>
<p>FigTree is designed as a graphical viewer of phylogenetic trees and as a program for producing publication-ready figures.</p>
<p>Download locally to your laptop: https://github.com/rambaut/figtree/releases / or access through Guacamole graphical user interface</p>
<p><br></p>
</section>
</section>
</section>
<section id="walk-throughs" class="level1">
<h1>Walk throughs</h1>
<section id="single-gene" class="level2">
<h2 class="anchored" data-anchor-id="single-gene">Single Gene</h2>
<iframe data-external="1" src="https://cardiff.cloud.panopto.eu/Panopto/Pages/Embed.aspx?id=f3046618-4e2d-4abc-ba0c-af630098dd8c&amp;autoplay=false&amp;offerviewer=true&amp;showtitle=true&amp;showbrand=true&amp;captions=false&amp;interactivity=all" height="405" width="720" style="border: 1px solid #464646;" allowfullscreen="" allow="autoplay">
</iframe>
</section>
<section id="whole-genome-snp" class="level2">
<h2 class="anchored" data-anchor-id="whole-genome-snp">Whole Genome SNP</h2>
<iframe data-external="1" src="https://cardiff.cloud.panopto.eu/Panopto/Pages/Embed.aspx?id=d2cf9c78-0062-496f-bfe0-af630098da10&amp;autoplay=false&amp;offerviewer=true&amp;showtitle=true&amp;showbrand=true&amp;captions=false&amp;interactivity=all" height="405" width="720" style="border: 1px solid #464646;" allowfullscreen="" allow="autoplay">
</iframe>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>